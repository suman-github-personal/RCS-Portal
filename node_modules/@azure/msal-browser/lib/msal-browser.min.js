/*! @azure/msal-browser v2.8.0 2020-12-07 */
"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).msal={})}(this,function(T){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function e(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function y(i,a,s,c){return new(s=s||Promise)(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,a||[])).next())})}function g(r,n){var o,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function o(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function t(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var l=function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function C(i,a,s,c){return new(s=s||Promise)(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,a||[])).next())})}function I(r,n){var o,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function a(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}var s,r,h,c,u,p,f,m,E,v,S={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/"};(r=s=s||{}).CONTENT_TYPE="Content-Type",r.X_CLIENT_CURR_TELEM="x-client-current-telemetry",r.X_CLIENT_LAST_TELEM="x-client-last-telemetry",r.RETRY_AFTER="Retry-After",r.X_MS_LIB_CAPABILITY="x-ms-lib-capability",r.X_MS_LIB_CAPABILITY_VALUE="retry-after, h429",(c=h=h||{}).ID_TOKEN="idtoken",c.CLIENT_INFO="client.info",c.ADAL_ID_TOKEN="adal.idtoken",c.ERROR="error",c.ERROR_DESC="error.description",(p=u=u||{}).COMMON="common",p.ORGANIZATIONS="organizations",p.CONSUMERS="consumers",(m=f=f||{}).CLIENT_ID="client_id",m.REDIRECT_URI="redirect_uri",m.RESPONSE_TYPE="response_type",m.RESPONSE_MODE="response_mode",m.GRANT_TYPE="grant_type",m.CLAIMS="claims",m.SCOPE="scope",m.ERROR="error",m.ERROR_DESCRIPTION="error_description",m.ACCESS_TOKEN="access_token",m.ID_TOKEN="id_token",m.REFRESH_TOKEN="refresh_token",m.EXPIRES_IN="expires_in",m.STATE="state",m.NONCE="nonce",m.PROMPT="prompt",m.SESSION_STATE="session_state",m.CLIENT_INFO="client_info",m.CODE="code",m.CODE_CHALLENGE="code_challenge",m.CODE_CHALLENGE_METHOD="code_challenge_method",m.CODE_VERIFIER="code_verifier",m.CLIENT_REQUEST_ID="client-request-id",m.X_CLIENT_SKU="x-client-SKU",m.X_CLIENT_VER="x-client-VER",m.X_CLIENT_OS="x-client-OS",m.X_CLIENT_CPU="x-client-CPU",m.POST_LOGOUT_URI="post_logout_redirect_uri",m.ID_TOKEN_HINT="id_token_hint",m.DEVICE_CODE="device_code",m.CLIENT_SECRET="client_secret",m.CLIENT_ASSERTION="client_assertion",m.CLIENT_ASSERTION_TYPE="client_assertion_type",m.TOKEN_TYPE="token_type",m.REQ_CNF="req_cnf",m.OBO_ASSERTION="assertion",m.REQUESTED_TOKEN_USE="requested_token_use",m.ON_BEHALF_OF="on_behalf_of",m.FOCI="foci",(v=E=E||{}).ACCESS_TOKEN="access_token",v.XMS_CC="xms_cc";var w,A,R={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};(A=w=w||{}).ACCOUNT="account",A.SID="sid",A.LOGIN_HINT="login_hint",A.ID_TOKEN="id_token",A.DOMAIN_HINT="domain_hint",A.ORGANIZATIONS="organizations",A.CONSUMERS="consumers",A.ACCOUNT_ID="accountIdentifier",A.HOMEACCOUNT_ID="homeAccountIdentifier";w.SID,w.LOGIN_HINT;var _,b,O,k,N,P,U,L,M,q,D,H,K,x,F={PLAIN:"plain",S256:"S256"};(b=_=_||{}).QUERY="query",b.FRAGMENT="fragment",b.FORM_POST="form_post",(k=O=O||{}).IMPLICIT_GRANT="implicit",k.AUTHORIZATION_CODE_GRANT="authorization_code",k.CLIENT_CREDENTIALS_GRANT="client_credentials",k.RESOURCE_OWNER_PASSWORD_GRANT="password",k.REFRESH_TOKEN_GRANT="refresh_token",k.DEVICE_CODE_GRANT="device_code",k.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer",(P=N=N||{}).MSSTS_ACCOUNT_TYPE="MSSTS",P.ADFS_ACCOUNT_TYPE="ADFS",P.MSAV1_ACCOUNT_TYPE="MSA",P.GENERIC_ACCOUNT_TYPE="Generic",(L=U=U||{}).CACHE_KEY_SEPARATOR="-",L.CLIENT_INFO_SEPARATOR=".",(q=M=M||{}).ID_TOKEN="IdToken",q.ACCESS_TOKEN="AccessToken",q.REFRESH_TOKEN="RefreshToken",(H=D=D||{}).ACCOUNT="Account",H.CREDENTIAL="Credential",H.ID_TOKEN="IdToken",H.ACCESS_TOKEN="AccessToken",H.REFRESH_TOKEN="RefreshToken",H.APP_METADATA="AppMetadata",H.TEMPORARY="TempCache",H.TELEMETRY="Telemetry",H.UNDEFINED="Undefined",H.THROTTLING="Throttling",(x=K=K||{})[x.ADFS=1001]="ADFS",x[x.MSA=1002]="MSA",x[x.MSSTS=1003]="MSSTS",x[x.GENERIC=1004]="GENERIC",x[x.ACCESS_TOKEN=2001]="ACCESS_TOKEN",x[x.REFRESH_TOKEN=2002]="REFRESH_TOKEN",x[x.ID_TOKEN=2003]="ID_TOKEN",x[x.APP_METADATA=3001]="APP_METADATA",x[x.UNDEFINED=9999]="UNDEFINED";var G,B="appmetadata",j="1",Y={SCHEMA_VERSION:2,MAX_HEADER_BYTES:4e3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};(G=T.AuthenticationScheme||(T.AuthenticationScheme={})).POP="pop",G.BEARER="Bearer";var z,W,J=60,Q=3600,V="throttling",X="invalid_grant",Z="client_mismatch";(W=z=z||{}).username="username",W.password="password";var $,ee={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},te=(t(re,$=Error),re.createUnexpectedError=function(e){return new re(ee.unexpectedError.code,ee.unexpectedError.desc+": "+e)},re);function re(e,t,r){var n=this,o=t?e+": "+t:e;return n=$.call(this,o)||this,Object.setPrototypeOf(n,re.prototype),n.errorCode=e||S.EMPTY_STRING,n.errorMessage=t||"",n.subError=r||"",n.name="AuthError",n}var ne,oe={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},ie={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},ae={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},se={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},ce={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},ue={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},de={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},he={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},le={code:"state_not_found",desc:"State not found"},pe={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},fe={code:"nonce_not_found",desc:"nonce not found"},ye={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},ge={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},me={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},Ee={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},ve={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},Te={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},Ce={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},Ie={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},Se={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},we={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},Ae={code:"device_code_expired",desc:"Device code is expired."},Re={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},_e={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},be={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},Oe={code:"no_account_found",desc:"No account found in cache for given key."},ke={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},Ne={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},Pe={code:"invalid_cache_type",desc:"Invalid cache type"},Ue={code:"unexpected_account_type",desc:"Unexpected account type."},Le={code:"unexpected_credential_type",desc:"Unexpected credential type."},Me={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},qe={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},De={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},He={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},Ke={code:"authorization_code_missing_from_server_response",desc:"Srver response does not contain an authorization code to proceed"},xe=(t(Fe,ne=te),Fe.createClientInfoDecodingError=function(e){return new Fe(oe.code,oe.desc+" Failed with error: "+e)},Fe.createClientInfoEmptyError=function(){return new Fe(ie.code,""+ie.desc)},Fe.createTokenParsingError=function(e){return new Fe(ae.code,ae.desc+" Failed with error: "+e)},Fe.createTokenNullOrEmptyError=function(e){return new Fe(se.code,se.desc+" Raw Token Value: "+e)},Fe.createEndpointDiscoveryIncompleteError=function(e){return new Fe(ce.code,ce.desc+" Detail: "+e)},Fe.createHashNotDeserializedError=function(e){return new Fe(ue.code,ue.desc+" Given Object: "+e)},Fe.createInvalidStateError=function(e,t){return new Fe(de.code,de.desc+" Invalid State: "+e+", Root Err: "+t)},Fe.createStateMismatchError=function(){return new Fe(he.code,he.desc)},Fe.createStateNotFoundError=function(e){return new Fe(le.code,le.desc+":  "+e)},Fe.createNonceMismatchError=function(){return new Fe(pe.code,pe.desc)},Fe.createNonceNotFoundError=function(e){return new Fe(fe.code,fe.desc+":  "+e)},Fe.createNoTokensFoundError=function(){return new Fe(ye.code,ye.desc)},Fe.createMultipleMatchingTokensInCacheError=function(){return new Fe(ge.code,ge.desc+".")},Fe.createMultipleMatchingAccountsInCacheError=function(){return new Fe(me.code,me.desc)},Fe.createMultipleMatchingAppMetadataInCacheError=function(){return new Fe(Ee.code,Ee.desc)},Fe.createTokenRequestCannotBeMadeError=function(){return new Fe(ve.code,ve.desc)},Fe.createAppendEmptyScopeToSetError=function(e){return new Fe(Te.code,Te.desc+" Given Scope: "+e)},Fe.createRemoveEmptyScopeFromSetError=function(e){return new Fe(Ce.code,Ce.desc+" Given Scope: "+e)},Fe.createAppendScopeSetError=function(e){return new Fe(Ie.code,Ie.desc+" Detail Error: "+e)},Fe.createEmptyInputScopeSetError=function(e){return new Fe(Se.code,Se.desc+" Given ScopeSet: "+e)},Fe.createDeviceCodeCancelledError=function(){return new Fe(we.code,""+we.desc)},Fe.createDeviceCodeExpiredError=function(){return new Fe(Ae.code,""+Ae.desc)},Fe.createNoAccountInSilentRequestError=function(){return new Fe(Re.code,""+Re.desc)},Fe.createNullOrUndefinedCacheRecord=function(){return new Fe(_e.code,_e.desc)},Fe.createInvalidCacheEnvironmentError=function(){return new Fe(be.code,be.desc)},Fe.createNoAccountFoundError=function(){return new Fe(Oe.code,Oe.desc)},Fe.createCachePluginError=function(){return new Fe(ke.code,""+ke.desc)},Fe.createNoCryptoObjectError=function(e){return new Fe(Ne.code,""+Ne.desc+e)},Fe.createInvalidCacheTypeError=function(){return new Fe(Pe.code,""+Pe.desc)},Fe.createUnexpectedAccountTypeError=function(){return new Fe(Ue.code,""+Ue.desc)},Fe.createUnexpectedCredentialTypeError=function(){return new Fe(Le.code,""+Le.desc)},Fe.createInvalidAssertionError=function(){return new Fe(Me.code,""+Me.desc)},Fe.createInvalidCredentialError=function(){return new Fe(qe.code,""+qe.desc)},Fe.createRefreshRequiredError=function(){return new Fe(De.code,De.desc)},Fe.createTokenClaimsRequiredError=function(){return new Fe(He.code,He.desc)},Fe.createNoAuthCodeInServerResponseError=function(){return new Fe(Ke.code,Ke.desc)},Fe);function Fe(e,t){var r=ne.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,Fe.prototype),r}var Ge,Be=(je.decodeAuthToken=function(e){if(je.isEmpty(e))throw xe.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw xe.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},je.isEmpty=function(e){return void 0===e||!e||0===e.length},je.startsWith=function(e,t){return 0===e.indexOf(t)},je.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},je.queryStringToObject=function(e){function t(e){return decodeURIComponent(decodeURIComponent(e.replace(n," ")))}var r,n=/\+/g,o=/([^&=]+)=([^&]*)/g,i={};for(r=o.exec(e);r;)i[t(r[1])]=t(r[2]),r=o.exec(e);return i},je.trimArrayEntries=function(e){return e.map(function(e){return e.trim()})},je.removeEmptyStringsFromArray=function(e){return e.filter(function(e){return!je.isEmpty(e)})},je.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},je.matchPattern=function(e,t){return new RegExp(e.replace(/\*/g,"[^ ]*")).test(t)},je);function je(){}(Ge=T.LogLevel||(T.LogLevel={}))[Ge.Error=0]="Error",Ge[Ge.Warning=1]="Warning",Ge[Ge.Info=2]="Info",Ge[Ge.Verbose=3]="Verbose";var Ye=(ze.prototype.clone=function(e,t){return new ze({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level},e,t)},ze.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(Be.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+T.LogLevel[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},ze.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},ze.prototype.error=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Error,containsPii:!1,correlationId:t||""})},ze.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Error,containsPii:!0,correlationId:t||""})},ze.prototype.warning=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Warning,containsPii:!1,correlationId:t||""})},ze.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Warning,containsPii:!0,correlationId:t||""})},ze.prototype.info=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Info,containsPii:!1,correlationId:t||""})},ze.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Info,containsPii:!0,correlationId:t||""})},ze.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Verbose,containsPii:!1,correlationId:t||""})},ze.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:T.LogLevel.Verbose,containsPii:!0,correlationId:t||""})},ze.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},ze);function ze(e,t,r){this.level=T.LogLevel.Info;this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=e.logLevel||T.LogLevel.Info,this.packageName=t||S.EMPTY_STRING,this.packageVersion=r||S.EMPTY_STRING}var We="2.0.0",Je=(Qe.prototype.generateAccountId=function(){return Qe.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},Qe.prototype.generateCredentialId=function(){return Qe.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},Qe.prototype.generateTarget=function(){return Qe.generateTargetForCacheKey(this.target)},Qe.prototype.generateCredentialKey=function(){return Qe.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},Qe.prototype.generateType=function(){switch(this.credentialType){case M.ID_TOKEN:return K.ID_TOKEN;case M.ACCESS_TOKEN:return K.ACCESS_TOKEN;case M.REFRESH_TOKEN:return K.REFRESH_TOKEN;default:throw xe.createUnexpectedCredentialTypeError()}},Qe.getCredentialType=function(e){return-1!==e.indexOf(M.ACCESS_TOKEN.toLowerCase())?M.ACCESS_TOKEN:-1!==e.indexOf(M.ID_TOKEN.toLowerCase())?M.ID_TOKEN:-1!==e.indexOf(M.REFRESH_TOKEN.toLowerCase())?M.REFRESH_TOKEN:S.NOT_DEFINED},Qe.generateCredentialCacheKey=function(e,t,r,n,o,i,a){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i)].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},Qe.generateAccountIdForCacheKey=function(e,t){return[e,t].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},Qe.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===M.REFRESH_TOKEN&&n||t,r||""].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},Qe.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},Qe);function Qe(){}var Ve,Xe={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Ze={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},$e={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},et={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},tt={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},rt={code:"empty_url_error",desc:"URL was empty or null."},nt={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},ot={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},it={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},at={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},st={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},ct={code:"token_request_empty",desc:"Token request was empty and not found in cache."},ut={code:"logout_request_empty",desc:"The logout request was null or undefined."},dt={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},ht={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},lt={code:"invalid_known_authorities",desc:"knownAuthorities and cloudDiscoveryMetadata cannot both be provided. Please provide cloudDiscoveryMetadata object for AAD, knownAuthorities otherwise."},pt={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},ft={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},yt={code:"resourceRequest_parameters_required",desc:"resourceRequestMethod and resourceRequestUri are required"},gt=(t(mt,Ve=xe),mt.createRedirectUriEmptyError=function(){return new mt(Xe.code,Xe.desc)},mt.createPostLogoutRedirectUriEmptyError=function(){return new mt(Ze.code,Ze.desc)},mt.createClaimsRequestParsingError=function(e){return new mt($e.code,$e.desc+" Given value: "+e)},mt.createInsecureAuthorityUriError=function(e){return new mt(et.code,et.desc+" Given URI: "+e)},mt.createUrlParseError=function(e){return new mt(tt.code,tt.desc+" Given Error: "+e)},mt.createUrlEmptyError=function(){return new mt(rt.code,rt.desc)},mt.createScopesNonArrayError=function(e){return new mt(ot.code,ot.desc+" Given Scopes: "+e)},mt.createEmptyScopesArrayError=function(e){return new mt(nt.code,nt.desc+" Given Scopes: "+e)},mt.createClientIdSingleScopeError=function(e){return new mt(it.code,it.desc+" Given Scopes: "+e)},mt.createInvalidPromptError=function(e){return new mt(at.code,at.desc+" Given value: "+e)},mt.createInvalidClaimsRequestError=function(){return new mt(st.code,st.desc)},mt.createEmptyLogoutRequestError=function(){return new mt(ut.code,ut.desc)},mt.createEmptyTokenRequestError=function(){return new mt(ct.code,ct.desc)},mt.createInvalidCodeChallengeMethodError=function(){return new mt(dt.code,dt.desc)},mt.createInvalidCodeChallengeParamsError=function(){return new mt(ht.code,ht.desc)},mt.createKnownAuthoritiesCloudDiscoveryMetadataError=function(){return new mt(lt.code,lt.desc)},mt.createInvalidCloudDiscoveryMetadataError=function(){return new mt(pt.code,pt.desc)},mt.createUntrustedAuthorityError=function(){return new mt(ft.code,ft.desc)},mt.createResourceRequestParametersRequiredError=function(){return new mt(yt.code,yt.desc)},mt);function mt(e,t){var r=Ve.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,mt.prototype),r}var Et,vt,Tt=(Ct.fromString=function(e){return new Ct((e=e||"").split(" "))},Ct.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw gt.createEmptyScopesArrayError(e)},Ct.prototype.containsScope=function(e){var t=new Ct(this.printScopesLowerCase().split(" "));return!Be.isEmpty(e)&&t.scopes.has(e.toLowerCase())},Ct.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})},Ct.prototype.containsOnlyDefaultScopes=function(){var e=0;return this.containsScope(S.OPENID_SCOPE)&&(e+=1),this.containsScope(S.PROFILE_SCOPE)&&(e+=1),this.containsScope(S.OFFLINE_ACCESS_SCOPE)&&(e+=1),this.scopes.size===e},Ct.prototype.appendScope=function(e){Be.isEmpty(e)||this.scopes.add(e.trim())},Ct.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(e){return t.appendScope(e)})}catch(e){throw xe.createAppendScopeSetError(e)}},Ct.prototype.removeScope=function(e){if(Be.isEmpty(e))throw xe.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},Ct.prototype.removeDefaultScopes=function(){this.scopes.delete(S.OFFLINE_ACCESS_SCOPE),this.scopes.delete(S.OPENID_SCOPE),this.scopes.delete(S.PROFILE_SCOPE)},Ct.prototype.unionScopeSets=function(e){if(!e)throw xe.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach(function(e){return t.add(e.toLowerCase())}),this.scopes.forEach(function(e){return t.add(e.toLowerCase())}),t},Ct.prototype.intersectingScopeSets=function(e){if(!e)throw xe.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e);e.containsOnlyDefaultScopes()||e.removeDefaultScopes();var r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},Ct.prototype.getScopeCount=function(){return this.scopes.size},Ct.prototype.asArray=function(){var t=[];return this.scopes.forEach(function(e){return t.push(e)}),t},Ct.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},Ct.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},Ct);function Ct(e){var t=this,r=e?Be.trimArrayEntries(a(e)):[],n=r?Be.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(function(e){return t.scopes.add(e)})}(vt=Et=Et||{})[vt.Default=0]="Default",vt[vt.Adfs=1]="Adfs";var It=(Object.defineProperty(St.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),St.canonicalizeUri=function(e){return e&&(e=e.toLowerCase(),Be.endsWith(e,"?")?e=e.slice(0,-1):Be.endsWith(e,"?/")&&(e=e.slice(0,-2)),Be.endsWith(e,"/")||(e+="/")),e},St.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw gt.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw gt.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw gt.createInsecureAuthorityUriError(this.urlString)},St.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},St.removeHashFromUrl=function(e){return St.canonicalizeUri(e.split("#")[0])},St.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==u.COMMON&&r[0]!==u.ORGANIZATIONS||(r[0]=e),St.constructAuthorityUriFromObject(t)},St.prototype.getHash=function(){return St.parseHash(this.urlString)},St.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw gt.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter(function(e){return e&&0<e.length}),r.PathSegments=n,!Be.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},St.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw gt.createUrlParseError("Given url string: "+e);return r[2]},St.getAbsoluteUrl=function(e,t){if(e[0]!==S.FORWARD_SLASH)return e;var r=new St(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e},St.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return-1<r?e.substring(r+2):-1<t?e.substring(t+1):""},St.constructAuthorityUriFromObject=function(e){return new St(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},St.getDeserializedHash=function(e){if(Be.isEmpty(e))return{};var t=St.parseHash(e),r=Be.queryStringToObject(Be.isEmpty(t)?e:t);if(!r)throw xe.createHashNotDeserializedError(JSON.stringify(r));return r},St.hashContainsKnownProperties=function(e){if(Be.isEmpty(e))return!1;var t=St.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},St);function St(e){if(this._urlString=e,Be.isEmpty(this._urlString))throw gt.createUrlEmptyError();Be.isEmpty(this.getHash())&&(this._urlString=St.canonicalizeUri(e))}var wt,At=(Rt.setTrustedAuthoritiesFromConfig=function(e,t){if(!this.getTrustedHostList().length){if(0<e.length&&!Be.isEmpty(t))throw gt.createKnownAuthoritiesCloudDiscoveryMetadataError();this.createCloudDiscoveryMetadataFromKnownAuthorities(e);try{if(t){var r=JSON.parse(t);this.saveCloudDiscoveryMetadata(r.metadata)}}catch(e){throw gt.createInvalidCloudDiscoveryMetadataError()}}},Rt.setTrustedAuthoritiesFromNetwork=function(i,a){return C(this,void 0,void 0,function(){var t,r,n,o;return I(this,function(e){switch(e.label){case 0:t=""+S.AAD_INSTANCE_DISCOVERY_ENDPT+i.urlString+"oauth2/v2.0/authorize",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a.sendGetRequestAsync(t)];case 2:return r=e.sent(),n=r.body.metadata,this.saveCloudDiscoveryMetadata(n),[3,4];case 3:return e.sent(),[2];case 4:return o=i.getUrlComponents().HostNameAndPort,0<this.getTrustedHostList().length&&!this.IsInTrustedHostList(o)&&this.createCloudDiscoveryMetadataFromKnownAuthorities([o]),[2]}})})},Rt.saveCloudDiscoveryMetadata=function(e){e.forEach(function(t){t.aliases.forEach(function(e){Rt.TrustedHostList[e.toLowerCase()]=t})})},Rt.createCloudDiscoveryMetadataFromKnownAuthorities=function(e){var r=this;e.forEach(function(e){var t=It.getDomainFromUrl(e).toLowerCase();r.TrustedHostList[t]={preferred_cache:t,preferred_network:t,aliases:[t]}})},Rt.getTrustedHostList=function(){return Object.keys(this.TrustedHostList)},Rt.getCloudDiscoveryMetadata=function(e){return this.TrustedHostList[e.toLowerCase()]||null},Rt.IsInTrustedHostList=function(e){return-1<Object.keys(this.TrustedHostList).indexOf(e.toLowerCase())},Rt.TrustedHostList={},Rt);function Rt(){}(wt=T.ProtocolMode||(T.ProtocolMode={})).AAD="AAD",wt.OIDC="OIDC";var _t=(Object.defineProperty(bt.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===S.ADFS?Et.Adfs:Et.Default},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"protocolMode",{get:function(){return this.authorityProtocolMode},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new It(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw xe.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw xe.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw xe.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw xe.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(bt.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw xe.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),bt.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(bt.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===Et.Adfs||this.protocolMode===T.ProtocolMode.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),bt.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},bt.prototype.discoverEndpoints=function(t){return C(this,void 0,void 0,function(){return I(this,function(e){return[2,this.networkInterface.sendGetRequestAsync(t)]})})},bt.prototype.validateAndSetPreferredNetwork=function(){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){switch(e.label){case 0:return t=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==At.getTrustedHostList().length?[3,2]:[4,At.setTrustedAuthoritiesFromNetwork(this._canonicalAuthority,this.networkInterface)];case 1:e.sent(),e.label=2;case 2:if(!At.IsInTrustedHostList(t))throw gt.createUntrustedAuthorityError();return r=At.getCloudDiscoveryMetadata(t).preferred_network,t!==r&&(this.canonicalAuthority=this.canonicalAuthority.replace(t,r)),[2]}})})},bt.prototype.resolveEndpointsAsync=function(){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){switch(e.label){case 0:return[4,this.validateAndSetPreferredNetwork()];case 1:return e.sent(),t=this.defaultOpenIdConfigurationEndpoint,[4,this.discoverEndpoints(t)];case 2:return r=e.sent(),this.tenantDiscoveryResponse=r.body,[2]}})})},bt.prototype.isAuthorityAlias=function(e){return e===this.canonicalAuthorityUrlComponents.HostNameAndPort||-1!==At.getCloudDiscoveryMetadata(this.canonicalAuthorityUrlComponents.HostNameAndPort).aliases.indexOf(e)},bt.generateEnvironmentFromAuthority=function(e){var t=e.canonicalAuthorityUrlComponents.HostNameAndPort;return At.getCloudDiscoveryMetadata(t)?At.getCloudDiscoveryMetadata(t).preferred_cache:""},bt);function bt(e,t,r){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.authorityProtocolMode=r}function Ot(e,t){if(Be.isEmpty(e))throw xe.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw xe.createClientInfoDecodingError(e)}}var kt=(Nt.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},Nt.prototype.generateAccountKey=function(){return Nt.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},Nt.prototype.generateType=function(){switch(this.authorityType){case N.ADFS_ACCOUNT_TYPE:return K.ADFS;case N.MSAV1_ACCOUNT_TYPE:return K.MSA;case N.MSSTS_ACCOUNT_TYPE:return K.MSSTS;case N.GENERIC_ACCOUNT_TYPE:return K.GENERIC;default:throw xe.createUnexpectedAccountTypeError()}},Nt.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},Nt.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},Nt.createAccount=function(e,t,r,n,o,i,a){var s,c,u,d,h,l,p=new Nt;p.authorityType=N.MSSTS_ACCOUNT_TYPE,p.clientInfo=e,p.homeAccountId=t;var f=_t.generateEnvironmentFromAuthority(r);if(Be.isEmpty(f))throw xe.createInvalidCacheEnvironmentError();return p.environment=f,p.realm=(null===(s=null==n?void 0:n.claims)||void 0===s?void 0:s.tid)||"",p.oboAssertion=o,n&&(p.idTokenClaims=n.claims,p.localAccountId=(null===(c=null==n?void 0:n.claims)||void 0===c?void 0:c.oid)||(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.sub)||"",p.username=(null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.preferred_username)||((null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.emails)?n.claims.emails[0]:""),p.name=null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.name),p.cloudGraphHostName=i,p.msGraphHost=a,p},Nt.createGenericAccount=function(e,t,r,n,o,i){var a,s,c,u,d=new Nt;d.authorityType=e.authorityType===Et.Adfs?N.ADFS_ACCOUNT_TYPE:N.GENERIC_ACCOUNT_TYPE,d.homeAccountId=t,d.realm="",d.oboAssertion=n;var h=_t.generateEnvironmentFromAuthority(e);if(Be.isEmpty(h))throw xe.createInvalidCacheEnvironmentError();return r&&(d.localAccountId=(null===(a=null==r?void 0:r.claims)||void 0===a?void 0:a.oid)||(null===(s=null==r?void 0:r.claims)||void 0===s?void 0:s.sub)||"",d.username=(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.upn)||"",d.name=(null===(u=null==r?void 0:r.claims)||void 0===u?void 0:u.name)||"",d.idTokenClaims=null==r?void 0:r.claims),d.environment=h,d.cloudGraphHostName=o,d.msGraphHost=i,d},Nt.generateHomeAccountId=function(e,t,r,n,o){var i,a=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:S.EMPTY_STRING;if(t===Et.Adfs)return a;if(e){var s=Ot(e,n);if(!Be.isEmpty(s.uid)&&!Be.isEmpty(s.utid))return""+s.uid+U.CLIENT_INFO_SEPARATOR+s.utid}return r.verbose("No client info in response"),a},Nt.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},Nt);function Nt(){}var Pt=(Ut.extractTokenClaims=function(e,t){var r=Be.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw xe.createTokenParsingError(e)}},Ut);function Ut(e,t){if(Be.isEmpty(e))throw xe.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=Ut.extractTokenClaims(e,t)}var Lt=(Mt.prototype.getAllAccounts=function(){var n=this,t=this.getAccountsFilteredBy(),e=Object.keys(t).map(function(e){return t[e]});return e.length<1?[]:e.map(function(e){var t=Mt.toObject(new kt,e).getAccountInfo(),r=n.readIdTokenFromCache(n.clientId,t);return r&&!t.idTokenClaims&&(t.idTokenClaims=new Pt(r.secret,n.cryptoImpl).claims),t})},Mt.prototype.saveCacheRecord=function(e){if(!e)throw xe.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)},Mt.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:M.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=Tt.fromString(e.target),o=Object.keys(r.accessTokens).map(function(e){return r.accessTokens[e]});o&&o.forEach(function(e){Tt.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)}),this.setAccessTokenCredential(e)},Mt.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},Mt.prototype.getAccountsFilteredByInternal=function(r,n,o){var i=this,e=this.getKeys(),a={};return e.forEach(function(e){var t=i.getAccount(e);t&&(r&&!i.matchHomeAccountId(t,r)||n&&!i.matchEnvironment(t,n)||o&&!i.matchRealm(t,o)||(a[e]=t))}),a},Mt.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},Mt.prototype.getCredentialsFilteredByInternal=function(n,o,i,a,s,c,u,d){var h=this,e=this.getKeys(),l={idTokens:{},accessTokens:{},refreshTokens:{}};return e.forEach(function(e){var t=Je.getCredentialType(e);if(t!==S.NOT_DEFINED){var r=h.getSpecificCredential(e,t);if(r&&(!d||h.matchOboAssertion(r,d))&&(!n||h.matchHomeAccountId(r,n))&&(!o||h.matchEnvironment(r,o))&&(!c||h.matchRealm(r,c))&&(!i||h.matchCredentialType(r,i))&&(!a||h.matchClientId(r,a))&&(!s||h.matchFamilyId(r,s))&&(!u||h.matchTarget(r,u)))switch(t){case M.ID_TOKEN:l.idTokens[e]=r;break;case M.ACCESS_TOKEN:l.accessTokens[e]=r;break;case M.REFRESH_TOKEN:l.refreshTokens[e]=r}}}),l},Mt.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},Mt.prototype.getAppMetadataFilteredByInternal=function(r,n){var o=this,e=this.getKeys(),i={};return e.forEach(function(e){if(o.isAppMetadata(e)){var t=o.getAppMetadata(e);t&&(r&&!o.matchEnvironment(t,r)||n&&!o.matchClientId(t,n)||(i[e]=t))}}),i},Mt.prototype.removeAllAccounts=function(){var t=this;return this.getKeys().forEach(function(e){t.getAccount(e)&&t.removeAccount(e)}),!0},Mt.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw xe.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,D.ACCOUNT)},Mt.prototype.removeAccountContext=function(e){var n=this,t=this.getKeys(),o=e.generateAccountId();return t.forEach(function(e){var t=Je.getCredentialType(e);if(t!==S.NOT_DEFINED){var r=n.getSpecificCredential(e,t);r&&o===r.generateAccountId()&&n.removeCredential(r)}}),!0},Mt.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,D.CREDENTIAL)},Mt.prototype.removeAppMetadata=function(){var t=this;return this.getKeys().forEach(function(e){t.isAppMetadata(e)&&t.removeItem(e,D.APP_METADATA)}),!0},Mt.prototype.readCacheRecord=function(e,t,r,n){var o=this.readAccountFromCache(e),i=this.readIdTokenFromCache(t,e),a=this.readAccessTokenFromCache(t,e,r),s=this.readRefreshTokenFromCache(t,e,!1),c=this.readAppMetadataFromCache(n,t);return o&&i&&(o.idTokenClaims=new Pt(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:a,refreshToken:s,appMetadata:c}},Mt.prototype.readAccountFromCache=function(e){var t=kt.generateAccountCacheKey(e);return this.getAccount(t)},Mt.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:M.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map(function(e){return n.idTokens[e]}),i=o.length;if(i<1)return null;if(1<i)throw xe.createMultipleMatchingTokensInCacheError();return o[0]},Mt.prototype.readAccessTokenFromCache=function(e,t,r){var n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:M.ACCESS_TOKEN,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase()},o=this.getCredentialsFilteredBy(n),i=Object.keys(o.accessTokens).map(function(e){return o.accessTokens[e]}),a=i.length;if(a<1)return null;if(1<a)throw xe.createMultipleMatchingTokensInCacheError();return i[0]},Mt.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?j:void 0,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:M.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),a=Object.keys(i.refreshTokens).map(function(e){return i.refreshTokens[e]});return a.length<1?null:a[0]},Mt.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map(function(e){return n[e]}),i=o.length;if(i<1)return null;if(1<i)throw xe.createMultipleMatchingAppMetadataInCacheError();return o[0]},Mt.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||r.familyId!==j)},Mt.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},Mt.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},Mt.prototype.matchEnvironment=function(e,t){var r=At.getCloudDiscoveryMetadata(t);return!!(r&&-1<r.aliases.indexOf(e.environment))},Mt.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},Mt.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},Mt.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},Mt.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},Mt.prototype.matchTarget=function(e,t){if(e.credentialType!==M.ACCESS_TOKEN||!e.target)return!1;var r=Tt.fromString(e.target),n=Tt.fromString(t);return n.containsOnlyDefaultScopes()||n.removeDefaultScopes(),r.containsScopeSet(n)},Mt.prototype.isAppMetadata=function(e){return-1!==e.indexOf(B)},Mt.prototype.getSpecificCredential=function(e,t){switch(t){case M.ID_TOKEN:return this.getIdTokenCredential(e);case M.ACCESS_TOKEN:return this.getAccessTokenCredential(e);case M.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},Mt.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},Mt);function Mt(e,t){this.clientId=e,this.cryptoImpl=t}var qt,Dt=(t(Ht,qt=Lt),Ht.prototype.setAccount=function(){throw te.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},Ht.prototype.getAccount=function(){throw te.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},Ht.prototype.setIdTokenCredential=function(){throw te.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},Ht.prototype.getIdTokenCredential=function(){throw te.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},Ht.prototype.setAccessTokenCredential=function(){throw te.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},Ht.prototype.getAccessTokenCredential=function(){throw te.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},Ht.prototype.setRefreshTokenCredential=function(){throw te.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},Ht.prototype.getRefreshTokenCredential=function(){throw te.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},Ht.prototype.setAppMetadata=function(){throw te.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},Ht.prototype.getAppMetadata=function(){throw te.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},Ht.prototype.setServerTelemetry=function(){throw te.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},Ht.prototype.getServerTelemetry=function(){throw te.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},Ht.prototype.setThrottlingCache=function(){throw te.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},Ht.prototype.getThrottlingCache=function(){throw te.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},Ht.prototype.removeItem=function(){throw te.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},Ht.prototype.containsKey=function(){throw te.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},Ht.prototype.getKeys=function(){throw te.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},Ht.prototype.clear=function(){throw te.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},Ht);function Ht(){return null!==qt&&qt.apply(this,arguments)||this}var Kt={tokenRenewalOffsetSeconds:300},xt={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:T.LogLevel.Info},Ft={sendGetRequestAsync:function(){return C(this,void 0,void 0,function(){return I(this,function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",te.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return C(this,void 0,void 0,function(){return I(this,function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",te.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},Gt={createNewGuid:function(){throw te.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw te.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw te.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return C(this,void 0,void 0,function(){return I(this,function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",te.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})},getPublicKeyThumbprint:function(){return C(this,void 0,void 0,function(){return I(this,function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",te.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")})})},signJwt:function(){return C(this,void 0,void 0,function(){return I(this,function(e){throw"Crypto interface - signJwt() has not been implemented",te.createUnexpectedError("Crypto interface - signJwt() has not been implemented")})})}},Bt={sku:S.SKU,version:We,cpu:"",os:""},jt={clientSecret:"",clientAssertion:void 0};function Yt(e){var t=e.authOptions,r=e.systemOptions,n=e.loggerOptions,o=e.storageInterface,i=e.networkInterface,a=e.cryptoInterface,s=e.clientCredentials,c=e.libraryInfo,u=e.serverTelemetryManager,d=e.persistencePlugin,h=e.serializableCache;return{authOptions:function(e){return l({knownAuthorities:[],cloudDiscoveryMetadata:"",clientCapabilities:[],protocolMode:T.ProtocolMode.AAD},e)}(t),systemOptions:l(l({},Kt),r),loggerOptions:l(l({},xt),n),storageInterface:o||new Dt(t.clientId,a||Gt),networkInterface:i||Ft,cryptoInterface:a||Gt,clientCredentials:s||jt,libraryInfo:l(l({},Bt),c),serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null}}var zt,Wt=(t(Jt,zt=te),Jt);function Jt(e,t,r){var n=zt.call(this,e,t,r)||this;return n.name="ServerError",Object.setPrototypeOf(n,Jt.prototype),n}var Qt=(Vt.generateThrottlingStorageKey=function(e){return V+"."+JSON.stringify(e)},Vt.preProcess=function(e,t){var r,n=Vt.generateThrottlingStorageKey(t),o=e.getThrottlingCache(n);if(o){if(o.throttleTime<Date.now())return void e.removeItem(n,D.THROTTLING);throw new Wt((null===(r=o.errorCodes)||void 0===r?void 0:r.join(" "))||S.EMPTY_STRING,o.errorMessage,o.subError)}},Vt.postProcess=function(e,t,r){if(Vt.checkResponseStatus(r)||Vt.checkResponseForRetryAfter(r)){var n={throttleTime:Vt.calculateThrottleTime(parseInt(r.headers[s.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Vt.generateThrottlingStorageKey(t),n)}},Vt.checkResponseStatus=function(e){return 429===e.status||500<=e.status&&e.status<600},Vt.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(s.RETRY_AFTER)&&(e.status<200||300<=e.status)},Vt.calculateThrottleTime=function(e){e<=0&&(e=0);var t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+(e||J),t+Q))},Vt.removeThrottle=function(e,t,r,n,o){var i={clientId:t,authority:r,scopes:n,homeAccountIdentifier:o},a=this.generateThrottlingStorageKey(i);return e.removeItem(a,D.THROTTLING)},Vt);function Vt(){}var Xt=(Zt.prototype.sendPostRequest=function(r,n,o){return C(this,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return Qt.preProcess(this.cacheManager,r),[4,this.networkClient.sendPostRequestAsync(n,o)];case 1:return t=e.sent(),Qt.postProcess(this.cacheManager,r,t),[2,t]}})})},Zt);function Zt(e,t){this.networkClient=e,this.cacheManager=t}var $t=(er.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e[s.CONTENT_TYPE]=S.URL_FORM_CONTENT_TYPE,e[s.X_MS_LIB_CAPABILITY]=s.X_MS_LIB_CAPABILITY_VALUE,this.serverTelemetryManager&&(e[s.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),e[s.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),e},er.prototype.createDefaultLibraryHeaders=function(){var e={};return e[f.X_CLIENT_SKU]=this.config.libraryInfo.sku,e[f.X_CLIENT_VER]=this.config.libraryInfo.version,e[f.X_CLIENT_OS]=this.config.libraryInfo.os,e[f.X_CLIENT_CPU]=this.config.libraryInfo.cpu,e},er.prototype.executePostToTokenEndpoint=function(r,n,o,i){return C(this,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return[4,this.networkManager.sendPostRequest(i,r,{body:n,headers:o})];case 1:return t=e.sent(),this.config.serverTelemetryManager&&t.status<500&&429!==t.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,t]}})})},er.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw xe.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},er);function er(e){this.config=Yt(e),this.logger=new Ye(this.config.loggerOptions,"@azure/msal-common",We),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Xt(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,At.setTrustedAuthoritiesFromConfig(this.config.authOptions.knownAuthorities,this.config.authOptions.cloudDiscoveryMetadata),this.authority=this.config.authOptions.authority}var tr=(rr.validateRedirectUri=function(e){if(Be.isEmpty(e))throw gt.createRedirectUriEmptyError()},rr.validatePrompt=function(e){if([R.LOGIN,R.SELECT_ACCOUNT,R.CONSENT,R.NONE].indexOf(e)<0)throw gt.createInvalidPromptError(e)},rr.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw gt.createInvalidClaimsRequestError()}},rr.validateCodeChallengeParams=function(e,t){if(Be.isEmpty(e)||Be.isEmpty(t))throw gt.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},rr.validateCodeChallengeMethod=function(e){if([F.PLAIN,F.S256].indexOf(e)<0)throw gt.createInvalidCodeChallengeMethodError()},rr.sanitizeEQParams=function(r,e){return r?(e.forEach(function(e,t){r[t]&&delete r[t]}),r):{}},rr);function rr(){}var nr=(or.prototype.addResponseTypeCode=function(){this.parameters.set(f.RESPONSE_TYPE,encodeURIComponent(S.CODE_RESPONSE_TYPE))},or.prototype.addResponseMode=function(e){this.parameters.set(f.RESPONSE_MODE,encodeURIComponent(e||_.QUERY))},or.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?a(e||[],[S.OPENID_SCOPE,S.PROFILE_SCOPE]):e||[],n=new Tt(r);this.parameters.set(f.SCOPE,encodeURIComponent(n.printScopes()))},or.prototype.addClientId=function(e){this.parameters.set(f.CLIENT_ID,encodeURIComponent(e))},or.prototype.addRedirectUri=function(e){tr.validateRedirectUri(e),this.parameters.set(f.REDIRECT_URI,encodeURIComponent(e))},or.prototype.addPostLogoutRedirectUri=function(e){tr.validateRedirectUri(e),this.parameters.set(f.POST_LOGOUT_URI,encodeURIComponent(e))},or.prototype.addIdTokenHint=function(e){this.parameters.set(f.ID_TOKEN_HINT,encodeURIComponent(e))},or.prototype.addDomainHint=function(e){this.parameters.set(w.DOMAIN_HINT,encodeURIComponent(e))},or.prototype.addLoginHint=function(e){this.parameters.set(w.LOGIN_HINT,encodeURIComponent(e))},or.prototype.addSid=function(e){this.parameters.set(w.SID,encodeURIComponent(e))},or.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);tr.validateClaims(r),this.parameters.set(f.CLAIMS,encodeURIComponent(r))},or.prototype.addCorrelationId=function(e){this.parameters.set(f.CLIENT_REQUEST_ID,encodeURIComponent(e))},or.prototype.addLibraryInfo=function(e){this.parameters.set(f.X_CLIENT_SKU,e.sku),this.parameters.set(f.X_CLIENT_VER,e.version),this.parameters.set(f.X_CLIENT_OS,e.os),this.parameters.set(f.X_CLIENT_CPU,e.cpu)},or.prototype.addPrompt=function(e){tr.validatePrompt(e),this.parameters.set(""+f.PROMPT,encodeURIComponent(e))},or.prototype.addState=function(e){Be.isEmpty(e)||this.parameters.set(f.STATE,encodeURIComponent(e))},or.prototype.addNonce=function(e){this.parameters.set(f.NONCE,encodeURIComponent(e))},or.prototype.addCodeChallengeParams=function(e,t){if(tr.validateCodeChallengeParams(e,t),!e||!t)throw gt.createInvalidCodeChallengeParamsError();this.parameters.set(f.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(f.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},or.prototype.addAuthorizationCode=function(e){this.parameters.set(f.CODE,encodeURIComponent(e))},or.prototype.addDeviceCode=function(e){this.parameters.set(f.DEVICE_CODE,encodeURIComponent(e))},or.prototype.addRefreshToken=function(e){this.parameters.set(f.REFRESH_TOKEN,encodeURIComponent(e))},or.prototype.addCodeVerifier=function(e){this.parameters.set(f.CODE_VERIFIER,encodeURIComponent(e))},or.prototype.addClientSecret=function(e){this.parameters.set(f.CLIENT_SECRET,encodeURIComponent(e))},or.prototype.addClientAssertion=function(e){this.parameters.set(f.CLIENT_ASSERTION,encodeURIComponent(e))},or.prototype.addClientAssertionType=function(e){this.parameters.set(f.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},or.prototype.addOboAssertion=function(e){this.parameters.set(f.OBO_ASSERTION,encodeURIComponent(e))},or.prototype.addRequestTokenUse=function(e){this.parameters.set(f.REQUESTED_TOKEN_USE,encodeURIComponent(e))},or.prototype.addGrantType=function(e){this.parameters.set(f.GRANT_TYPE,encodeURIComponent(e))},or.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},or.prototype.addExtraQueryParameters=function(t){var r=this;tr.sanitizeEQParams(t,this.parameters),Object.keys(t).forEach(function(e){r.parameters.set(e,t[e])})},or.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw gt.createInvalidClaimsRequestError()}else r={};return t&&0<t.length&&(r.hasOwnProperty(E.ACCESS_TOKEN)||(r[E.ACCESS_TOKEN]={}),r[E.ACCESS_TOKEN][E.XMS_CC]={values:t}),JSON.stringify(r)},or.prototype.addUsername=function(e){this.parameters.set(z.username,e)},or.prototype.addPassword=function(e){this.parameters.set(z.password,e)},or.prototype.addPopToken=function(e){Be.isEmpty(e)||(this.parameters.set(f.TOKEN_TYPE,T.AuthenticationScheme.POP),this.parameters.set(f.REQ_CNF,encodeURIComponent(e)))},or.prototype.createQueryString=function(){var r=new Array;return this.parameters.forEach(function(e,t){r.push(t+"="+e)}),r.join("&")},or);function or(){this.parameters=new Map}var ir=(ar.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},ar.isTokenExpired=function(e,t){return(Number(e)||0)<ar.nowSeconds()+t},ar);function ar(){}var sr,cr=(t(ur,sr=Je),ur.createIdTokenEntity=function(e,t,r,n,o,i){var a=new ur;return a.credentialType=M.ID_TOKEN,a.homeAccountId=e,a.environment=t,a.clientId=n,a.secret=r,a.realm=o,a.oboAssertion=i,a},ur.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===M.ID_TOKEN},ur);function ur(){return null!==sr&&sr.apply(this,arguments)||this}var dr,hr=(t(lr,dr=Je),lr.createAccessTokenEntity=function(e,t,r,n,o,i,a,s,c,u){var d=new lr;d.homeAccountId=e,d.credentialType=M.ACCESS_TOKEN,d.secret=r;var h=ir.nowSeconds();return d.cachedAt=h.toString(),d.expiresOn=a.toString(),d.extendedExpiresOn=s.toString(),d.environment=t,d.clientId=n,d.realm=o,d.target=i,d.oboAssertion=u,d.tokenType=Be.isEmpty(c)?T.AuthenticationScheme.BEARER:c,d},lr.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&e.credentialType===M.ACCESS_TOKEN},lr);function lr(){return null!==dr&&dr.apply(this,arguments)||this}var pr,fr=(t(yr,pr=Je),yr.createRefreshTokenEntity=function(e,t,r,n,o,i){var a=new yr;return a.clientId=n,a.credentialType=M.REFRESH_TOKEN,a.environment=t,a.homeAccountId=e,a.secret=r,a.oboAssertion=i,o&&(a.familyId=o),a},yr.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===M.REFRESH_TOKEN},yr);function yr(){return null!==pr&&pr.apply(this,arguments)||this}var gr,mr=["interaction_required","consent_required","login_required"],Er=["message_only","additional_action","basic_action","user_password_expired","consent_required"],vr=(t(Tr,gr=Wt),Tr.isInteractionRequiredError=function(e,t,r){var n=!!e&&-1<mr.indexOf(e),o=!!r&&-1<Er.indexOf(r),i=!!t&&mr.some(function(e){return-1<t.indexOf(e)});return n||i||o},Tr);function Tr(e,t,r){var n=gr.call(this,e,t,r)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,Tr.prototype),n}var Cr,Ir,Sr=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},wr=(Ar.setRequestState=function(e,t,r){var n=Ar.generateLibraryState(e,r);return Be.isEmpty(t)?n:""+n+S.RESOURCE_DELIM+t},Ar.generateLibraryState=function(e,t){if(!e)throw xe.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid(),ts:ir.nowSeconds()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},Ar.parseRequestState=function(e,t){if(!e)throw xe.createNoCryptoObjectError("parseRequestState");if(Be.isEmpty(t))throw xe.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(S.RESOURCE_DELIM),n=r[0],o=1<r.length?r.slice(1).join(S.RESOURCE_DELIM):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:Be.isEmpty(o)?"":o,libraryState:a}}catch(e){throw xe.createInvalidStateError(t,e)}},Ar);function Ar(){}(Ir=Cr=Cr||{}).SW="sw",Ir.UHW="uhw";var Rr=(_r.prototype.generateCnf=function(n,o){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){switch(e.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(n,o)];case 1:return t=e.sent(),r={kid:t,xms_ksl:Cr.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(r))]}})})},_r.prototype.signPopToken=function(o,i,a){var s;return C(this,void 0,void 0,function(){var t,r,n;return I(this,function(e){switch(e.label){case 0:if(t=Pt.extractTokenClaims(o,this.cryptoUtils),r=new It(a),n=r.getUrlComponents(),!(null===(s=null==t?void 0:t.cnf)||void 0===s?void 0:s.kid))throw xe.createTokenClaimsRequiredError();return[4,this.cryptoUtils.signJwt({at:o,ts:""+ir.nowSeconds(),m:i.toUpperCase(),u:n.HostNameAndPort||"",nonce:this.cryptoUtils.createNewGuid(),p:n.AbsolutePath,q:[[],n.QueryString]},t.cnf.kid)];case 1:return[2,e.sent()]}})})},_r);function _r(e){this.cryptoUtils=e}var br=(Or.prototype.generateAppMetadataKey=function(){return Or.generateAppMetadataCacheKey(this.environment,this.clientId)},Or.generateAppMetadataCacheKey=function(e,t){return[B,e,t].join(U.CACHE_KEY_SEPARATOR).toLowerCase()},Or.createAppMetadataEntity=function(e,t,r){var n=new Or;return n.clientId=e,n.environment=t,r&&(n.familyId=r),n},Or.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(B)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},Or);function Or(){}var kr=(Object.defineProperty(Nr.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!0,configurable:!0}),Object.defineProperty(Nr.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!0,configurable:!0}),Nr);function Nr(e,t){this.cache=e,this.hasChanged=t}var Pr=(Ur.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?xe.createStateNotFoundError("Cached State"):xe.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw xe.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(vr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new vr(e.error||S.EMPTY_STRING,e.error_description,e.suberror);throw new Wt(e.error||S.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Ot(e.client_info,r)},Ur.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(vr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new vr(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Wt(e.error,t)}},Ur.prototype.handleServerTokenResponse=function(a,s,c,u,d,h,l,p){return C(this,void 0,void 0,function(){var t,r,n,o,i;return I(this,function(e){switch(e.label){case 0:if(a.id_token&&(t=new Pt(a.id_token||S.EMPTY_STRING,this.cryptoObj),d&&!Be.isEmpty(d.nonce)&&t.claims.nonce!==d.nonce))throw xe.createNonceMismatchError();this.homeAccountIdentifier=kt.generateHomeAccountId(a.client_info||S.EMPTY_STRING,s.authorityType,this.logger,this.cryptoObj,t),d&&d.state&&(r=wr.parseRequestState(this.cryptoObj,d.state)),n=this.generateCacheRecord(a,s,t,r&&r.libraryState,h,l,d),e.label=1;case 1:return e.trys.push([1,,4,7]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),o=new kr(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(o)]):[3,3];case 2:e.sent(),e.label=3;case 3:return p&&n.account&&(i=n.account.generateAccountKey(),!this.cacheStorage.getAccount(i))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,null]):(this.cacheStorage.saveCacheRecord(n),[3,7]);case 4:return this.persistencePlugin&&this.serializableCache&&o?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(o)]):[3,6];case 5:e.sent(),e.label=6;case 6:return[7];case 7:return[2,Ur.generateAuthenticationResult(this.cryptoObj,s,n,!1,t,r,c,u)]}})})},Ur.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s,c,u=_t.generateEnvironmentFromAuthority(t);if(Be.isEmpty(u))throw xe.createInvalidCacheEnvironmentError();!Be.isEmpty(e.id_token)&&r&&(s=cr.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||S.EMPTY_STRING,this.clientId,r.claims.tid||S.EMPTY_STRING,i),c=this.generateAccountEntity(e,r,t,i,a));var d=null;if(!Be.isEmpty(e.access_token)){var h=e.scope?Tt.fromString(e.scope):new Tt(o||[]),l=ir.nowSeconds(),p=(n?n.ts:l)+(e.expires_in||0),f=p+(e.ext_expires_in||0);d=hr.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||S.EMPTY_STRING,this.clientId,r?r.claims.tid||S.EMPTY_STRING:t.tenant,h.printScopes(),p,f,e.token_type,i)}var y=null;Be.isEmpty(e.refresh_token)||(y=fr.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||S.EMPTY_STRING,this.clientId,e.foci,i));var g=null;return Be.isEmpty(e.foci)||(g=br.createAppMetadataEntity(this.clientId,u,e.foci)),new Sr(c,s,d,y,g)},Ur.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,a=o?o.cloud_graph_host_name:"",s=o?o.msgraph_host:"";if(i===Et.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),kt.createGenericAccount(r,this.homeAccountIdentifier,t,n,a,s);if(Be.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw xe.createClientInfoEmptyError();return e.client_info?kt.createAccount(e.client_info,this.homeAccountIdentifier,r,t,n,a,s):kt.createGenericAccount(r,this.homeAccountIdentifier,t,n,a,s)},Ur.generateAuthenticationResult=function(u,d,h,l,p,f,y,g){var m,E,v;return C(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c;return I(this,function(e){switch(e.label){case 0:if(t="",r=[],n=null,i=S.EMPTY_STRING,!h.accessToken)return[3,4];if(h.accessToken.tokenType!==T.AuthenticationScheme.POP)return[3,2];if(a=new Rr(u),!y||!g)throw gt.createResourceRequestParametersRequiredError();return[4,a.signPopToken(h.accessToken.secret,y,g)];case 1:return t=e.sent(),[3,3];case 2:t=h.accessToken.secret,e.label=3;case 3:r=Tt.fromString(h.accessToken.target).asArray(),n=new Date(1e3*Number(h.accessToken.expiresOn)),o=new Date(1e3*Number(h.accessToken.extendedExpiresOn)),e.label=4;case 4:return h.appMetadata&&(i=h.appMetadata.familyId===j?j:S.EMPTY_STRING),s=(null==p?void 0:p.claims.oid)||(null==p?void 0:p.claims.sub)||S.EMPTY_STRING,c=(null==p?void 0:p.claims.tid)||S.EMPTY_STRING,[2,{authority:d.canonicalAuthority,uniqueId:s,tenantId:c,scopes:r,account:h.account?h.account.getAccountInfo():null,idToken:p?p.rawToken:S.EMPTY_STRING,idTokenClaims:p?p.claims:{},accessToken:t,fromCache:l,expiresOn:n,extExpiresOn:o,familyId:i,tokenType:(null===(m=h.accessToken)||void 0===m?void 0:m.tokenType)||S.EMPTY_STRING,state:f?f.userRequestState:S.EMPTY_STRING,cloudGraphHostName:(null===(E=h.account)||void 0===E?void 0:E.cloudGraphHostName)||S.EMPTY_STRING,msGraphHost:(null===(v=h.account)||void 0===v?void 0:v.msGraphHost)||S.EMPTY_STRING}]}})})},Ur);function Ur(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}var Lr,Mr=(t(qr,Lr=$t),qr.prototype.getAuthCodeUrl=function(r){return C(this,void 0,void 0,function(){var t;return I(this,function(e){return t=this.createAuthCodeUrlQueryString(r),[2,this.authority.authorizationEndpoint+"?"+t]})})},qr.prototype.acquireToken=function(n,o){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){switch(e.label){case 0:if(this.logger.info("in acquireToken call"),!n||Be.isEmpty(n.code))throw xe.createTokenRequestCannotBeMadeError();return[4,this.executeTokenRequest(this.authority,n)];case 1:return t=e.sent(),(r=new Pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(t.body),[4,r.handleServerTokenResponse(t.body,this.authority,n.resourceRequestMethod,n.resourceRequestUri,o)];case 2:return[2,e.sent()]}})})},qr.prototype.handleFragmentResponse=function(e,t){var r=new Pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new It(e),o=It.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw xe.createNoAuthCodeInServerResponseError();return l(l({},o),{code:o.code})},qr.prototype.getLogoutUri=function(e){if(!e)throw gt.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(kt.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=this.createLogoutUrlQueryString(e);return Be.isEmpty(t)?this.authority.endSessionEndpoint:this.authority.endSessionEndpoint+"?"+t},qr.prototype.executeTokenRequest=function(o,i){return C(this,void 0,void 0,function(){var t,r,n;return I(this,function(e){switch(e.label){case 0:return t={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:i.scopes},[4,this.createTokenRequestBody(i)];case 1:return r=e.sent(),n=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(o.tokenEndpoint,r,n,t)]}})})},qr.prototype.createTokenRequestBody=function(i){return C(this,void 0,void 0,function(){var t,r,n,o;return I(this,function(e){switch(e.label){case 0:return(t=new nr).addClientId(this.config.authOptions.clientId),t.addRedirectUri(i.redirectUri),t.addScopes(i.scopes),t.addAuthorizationCode(i.code),i.codeVerifier&&t.addCodeVerifier(i.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(O.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),i.authenticationScheme===T.AuthenticationScheme.POP&&i.resourceRequestMethod&&i.resourceRequestUri?[4,new Rr(this.cryptoUtils).generateCnf(i.resourceRequestMethod,i.resourceRequestUri)]:[3,2];case 1:n=e.sent(),t.addPopToken(n),e.label=2;case 2:return o=i.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!Be.isEmpty(i.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(i.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}})})},qr.prototype.createAuthCodeUrlQueryString=function(e){var t=new nr;t.addClientId(this.config.authOptions.clientId);var r=a(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.sid?t.addSid(e.sid):e.loginHint?t.addLoginHint(e.loginHint):e.account&&e.account.username&&t.addLoginHint(e.account.username),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!Be.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},qr.prototype.createLogoutUrlQueryString=function(e){var t=new nr;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),t.createQueryString()},qr);function qr(e){return Lr.call(this,e)||this}var Dr;t(Hr,Dr=$t),Hr.prototype.acquireToken=function(o){return C(this,void 0,void 0,function(){var t,r,n;return I(this,function(e){switch(e.label){case 0:return[4,this.getDeviceCode(o)];case 1:return t=e.sent(),o.deviceCodeCallback(t),[4,this.acquireTokenWithDeviceCode(o,t)];case 2:return r=e.sent(),(n=new Pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r),[4,n.handleServerTokenResponse(r,this.authority,o.resourceRequestMethod,o.resourceRequestUri)];case 3:return[2,e.sent()]}})})},Hr.prototype.getDeviceCode=function(o){return C(this,void 0,void 0,function(){var t,r,n;return I(this,function(e){return t=this.createQueryString(o),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:o.authority,scopes:o.scopes},[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,r,n)]})})},Hr.prototype.executePostRequestToDeviceCodeEndpoint=function(c,u,d,h){return C(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return I(this,function(e){switch(e.label){case 0:return[4,this.networkManager.sendPostRequest(h,c,{body:u,headers:d})];case 1:return t=e.sent().body,r=t.user_code,n=t.device_code,o=t.verification_uri,i=t.expires_in,a=t.interval,s=t.message,[2,{userCode:r,deviceCode:n,verificationUri:o,expiresIn:i,interval:a,message:s}]}})})},Hr.prototype.createQueryString=function(e){var t=new nr;return t.addScopes(e.scopes),t.addClientId(this.config.authOptions.clientId),(!Be.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},Hr.prototype.acquireTokenWithDeviceCode=function(d,n){return C(this,void 0,void 0,function(){var s,c,u,t,r=this;return I(this,function(e){return s=this.createTokenRequestBody(d,n),c=this.createDefaultTokenRequestHeaders(),u=ir.nowSeconds()+n.expiresIn,t=1e3*n.interval,[2,new Promise(function(o,i){var a=setInterval(function(){return C(r,void 0,void 0,function(){var t,r,n;return I(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),d.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(a),i(xe.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return ir.nowSeconds()>u?(this.logger.error("Device code expired. Expiration time of device code was "+u),clearInterval(a),i(xe.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return t={clientId:this.config.authOptions.clientId,authority:d.authority,scopes:d.scopes},[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,s,c,t)];case 3:(r=e.sent()).body&&r.body.error===S.AUTHORIZATION_PENDING?this.logger.info(r.body.error_description||"no_error_description"):(clearInterval(a),o(r.body)),e.label=4;case 4:return[3,6];case 5:return n=e.sent(),clearInterval(a),i(n),[3,6];case 6:return[2]}})})},t)})]})})},Hr.prototype.createTokenRequestBody=function(e,t){var r=new nr;r.addScopes(e.scopes),r.addClientId(this.config.authOptions.clientId),r.addGrantType(O.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(n),r.addClientInfo(),(!Be.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),r.createQueryString()};function Hr(e){return Dr.call(this,e)||this}var Kr,xr=(t(Fr,Kr=$t),Fr.prototype.acquireToken=function(n){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){switch(e.label){case 0:return[4,this.executeTokenRequest(n,this.authority)];case 1:return t=e.sent(),(r=new Pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(t.body),[2,r.handleServerTokenResponse(t.body,this.authority,n.resourceRequestMethod,n.resourceRequestUri,void 0,[],void 0,!0)]}})})},Fr.prototype.acquireTokenByRefreshToken=function(n){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){if(!n)throw gt.createEmptyTokenRequestError();if(!n.account)throw xe.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(n.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(n,!0)]}catch(e){if(t=e instanceof xe&&e.errorCode===ye.code,r=e instanceof Wt&&e.errorCode===X&&e.subError===Z,t||r)return[2,this.acquireTokenWithCachedRefreshToken(n,!1)];throw e}return[2,this.acquireTokenWithCachedRefreshToken(n,!1)]})})},Fr.prototype.acquireTokenWithCachedRefreshToken=function(n,o){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){if(!(t=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,n.account,o)))throw xe.createNoTokensFoundError();return r=l(l({},n),{refreshToken:t.secret,authenticationScheme:T.AuthenticationScheme.BEARER}),[2,this.acquireToken(r)]})})},Fr.prototype.executeTokenRequest=function(o,i){return C(this,void 0,void 0,function(){var t,r,n;return I(this,function(e){switch(e.label){case 0:return[4,this.createTokenRequestBody(o)];case 1:return t=e.sent(),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:i.canonicalAuthority,scopes:o.scopes},[2,this.executePostToTokenEndpoint(i.tokenEndpoint,t,r,n)]}})})},Fr.prototype.createTokenRequestBody=function(s){return C(this,void 0,void 0,function(){var t,r,n,o,i,a;return I(this,function(e){switch(e.label){case 0:if((t=new nr).addClientId(this.config.authOptions.clientId),t.addScopes(s.scopes),t.addGrantType(O.REFRESH_TOKEN_GRANT),t.addClientInfo(),r=s.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(s.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),s.authenticationScheme!==T.AuthenticationScheme.POP)return[3,2];if(o=new Rr(this.cryptoUtils),!s.resourceRequestMethod||!s.resourceRequestUri)throw gt.createResourceRequestParametersRequiredError();return a=(i=t).addPopToken,[4,o.generateCnf(s.resourceRequestMethod,s.resourceRequestUri)];case 1:a.apply(i,[e.sent()]),e.label=2;case 2:return(!Be.isEmpty(s.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(s.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}})})},Fr);function Fr(e){return Kr.call(this,e)||this}var Gr;t(Br,Gr=$t),Br.prototype.acquireToken=function(r){return C(this,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return this.scopeSet=new Tt(r.scopes||[]),r.skipCache?[4,this.executeTokenRequest(r,this.authority)]:[3,2];case 1:return[2,e.sent()];case 2:return[4,this.getCachedAuthenticationResult()];case 3:return(t=e.sent())?[2,t]:[3,4];case 4:return[4,this.executeTokenRequest(r,this.authority)];case 5:return[2,e.sent()]}})})},Br.prototype.getCachedAuthenticationResult=function(){return C(this,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return!(t=this.readAccessTokenFromCache())||ir.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:[4,Pr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:null,idToken:null,accessToken:t,refreshToken:null,appMetadata:null},!0)];case 1:return[2,e.sent()]}})})},Br.prototype.readAccessTokenFromCache=function(){var e={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:M.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},t=this.cacheManager.getCredentialsFilteredBy(e),r=Object.keys(t.accessTokens).map(function(e){return t.accessTokens[e]});if(r.length<1)return null;if(1<r.length)throw xe.createMultipleMatchingTokensInCacheError();return r[0]},Br.prototype.executeTokenRequest=function(a,s){return C(this,void 0,void 0,function(){var t,r,n,o,i;return I(this,function(e){switch(e.label){case 0:return t=this.createTokenRequestBody(a),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes},[4,this.executePostToTokenEndpoint(s.tokenEndpoint,t,r,n)];case 1:return o=e.sent(),(i=new Pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,a.resourceRequestMethod,a.resourceRequestUri,void 0,a.scopes)];case 2:return[2,e.sent()]}})})},Br.prototype.createTokenRequestBody=function(e){var t=new nr;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes,!1),t.addGrantType(O.CLIENT_CREDENTIALS_GRANT);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return(!Be.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()};function Br(e){return Gr.call(this,e)||this}var jr;t(Yr,jr=$t),Yr.prototype.acquireToken=function(r){return C(this,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return this.scopeSet=new Tt(r.scopes||[]),r.skipCache?[4,this.executeTokenRequest(r,this.authority)]:[3,2];case 1:return[2,e.sent()];case 2:return[4,this.getCachedAuthenticationResult(r)];case 3:return(t=e.sent())?[2,t]:[3,4];case 4:return[4,this.executeTokenRequest(r,this.authority)];case 5:return[2,e.sent()]}})})},Yr.prototype.getCachedAuthenticationResult=function(s){return C(this,void 0,void 0,function(){var t,r,n,o,i,a;return I(this,function(e){switch(e.label){case 0:return!(t=this.readAccessTokenFromCache(s))||ir.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:(r=this.readIdTokenFromCache(s),o=null,r&&(n=new Pt(r.secret,this.config.cryptoInterface),i=n.claims.oid?n.claims.oid:n.claims.sub,a={homeAccountId:r.homeAccountId,environment:r.environment,tenantId:r.realm,username:S.EMPTY_STRING,localAccountId:i||""},o=this.readAccountFromCache(a)),[4,Pr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:o,accessToken:t,idToken:r,refreshToken:null,appMetadata:null},!0,n)]);case 1:return[2,e.sent()]}})})},Yr.prototype.readAccessTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:M.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase(),oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.accessTokens).map(function(e){return r.accessTokens[e]}),o=n.length;if(o<1)return null;if(1<o)throw xe.createMultipleMatchingTokensInCacheError();return n[0]},Yr.prototype.readIdTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:M.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.idTokens).map(function(e){return r.idTokens[e]});return n.length<1?null:n[0]},Yr.prototype.readAccountFromCache=function(e){return this.cacheManager.readAccountFromCache(e)},Yr.prototype.executeTokenRequest=function(a,s){return C(this,void 0,void 0,function(){var t,r,n,o,i;return I(this,function(e){switch(e.label){case 0:return t=this.createTokenRequestBody(a),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes},[4,this.executePostToTokenEndpoint(s.tokenEndpoint,t,r,n)];case 1:return o=e.sent(),(i=new Pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,a.resourceRequestMethod,a.resourceRequestUri,void 0,a.scopes,a.oboAssertion)];case 2:return[2,e.sent()]}})})},Yr.prototype.createTokenRequestBody=function(e){var t=new nr;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(O.JWT_BEARER),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addRequestTokenUse(f.ON_BEHALF_OF),t.addOboAssertion(e.oboAssertion),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return t.createQueryString()};function Yr(e){return jr.call(this,e)||this}var zr,Wr=(t(Jr,zr=$t),Jr.prototype.acquireToken=function(r){return C(this,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.acquireCachedToken(r)];case 1:return[2,e.sent()];case 2:if((t=e.sent())instanceof xe&&t.errorCode===De.code)return[2,new xr(this.config).acquireTokenByRefreshToken(r)];throw t;case 3:return[2]}})})},Jr.prototype.acquireCachedToken=function(o){return C(this,void 0,void 0,function(){var t,r,n;return I(this,function(e){switch(e.label){case 0:if(!o)throw gt.createEmptyTokenRequestError();if(!o.account)throw xe.createNoAccountInSilentRequestError();if(t=new Tt(o.scopes||[]),r=o.authority||_t.generateEnvironmentFromAuthority(this.authority),n=this.cacheManager.readCacheRecord(o.account,this.config.authOptions.clientId,t,r),!this.isRefreshRequired(o,n.accessToken))return[3,1];throw xe.createRefreshRequiredError();case 1:return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(n,o.resourceRequestMethod,o.resourceRequestUri)];case 2:return[2,e.sent()]}})})},Jr.prototype.generateResultFromCacheRecord=function(r,n,o){return C(this,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return r.idToken&&(t=new Pt(r.idToken.secret,this.config.cryptoInterface)),[4,Pr.generateAuthenticationResult(this.cryptoUtils,this.authority,r,!0,t,void 0,n,o)];case 1:return[2,e.sent()]}})})},Jr.prototype.isRefreshRequired=function(e,t){return!(!e.forceRefresh&&!e.claims&&t&&!ir.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},Jr);function Jr(e){return zr.call(this,e)||this}var Qr;t(Vr,Qr=$t),Vr.prototype.acquireToken=function(n){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){switch(e.label){case 0:return this.logger.info("in acquireToken call"),[4,this.executeTokenRequest(this.authority,n)];case 1:return t=e.sent(),(r=new Pr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(t.body),[2,r.handleServerTokenResponse(t.body,this.authority)]}})})},Vr.prototype.executeTokenRequest=function(o,i){return C(this,void 0,void 0,function(){var t,r,n;return I(this,function(e){return t={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:i.scopes},r=this.createTokenRequestBody(i),n=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(o.tokenEndpoint,r,n,t)]})})},Vr.prototype.createTokenRequestBody=function(e){var t=new nr;t.addClientId(this.config.authOptions.clientId),t.addUsername(e.username),t.addPassword(e.password),t.addScopes(e.scopes),t.addGrantType(O.RESOURCE_OWNER_PASSWORD_GRANT),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(r),(!Be.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()};function Vr(e){return Qr.call(this,e)||this}var Xr=(Zr.createDiscoveredInstance=function(n,o,i){return C(this,void 0,void 0,function(){var t,r;return I(this,function(e){switch(e.label){case 0:if((t=Zr.createInstance(n,o,i)).discoveryComplete())return[2,t];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.resolveEndpointsAsync()];case 2:return e.sent(),[2,t];case 3:throw r=e.sent(),xe.createEndpointDiscoveryIncompleteError(r);case 4:return[2]}})})},Zr.createInstance=function(e,t,r){if(Be.isEmpty(e))throw gt.createUrlEmptyError();return new _t(e,t,r)},Zr);function Zr(){}var $r=(en.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Y.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},en);function en(){this.failedRequests=[],this.errors=[],this.cacheHits=0}var tn=(rn.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(V));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},rn);function rn(){}var nn=(on.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+Y.VALUE_SEPARATOR+e;return[Y.SCHEMA_VERSION,t,""].join(Y.CATEGORY_SEPARATOR)},on.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=on.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(Y.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(Y.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?Y.OVERFLOW_TRUE:Y.OVERFLOW_FALSE].join(Y.VALUE_SEPARATOR);return[Y.SCHEMA_VERSION,e.cacheHits,r,n,i].join(Y.CATEGORY_SEPARATOR)},on.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.failedRequests.push(this.apiId,this.correlationId),Be.isEmpty(e.subError)?Be.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Y.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},on.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},on.prototype.getLastRequests=function(){var e=new $r;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},on.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=on.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r=new $r;r.failedRequests=e.failedRequests.slice(2*t),r.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}},on.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||S.EMPTY_STRING,a=e.failedRequests[2*t+1]||S.EMPTY_STRING,s=e.errors[t]||S.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+s.length+3)<Y.MAX_HEADER_BYTES))break;r+=1}return r},on);function on(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.telemetryCacheKey=Y.CACHE_KEY+U.CACHE_KEY_SEPARATOR+e.clientId}var an,sn,cn,un,dn,hn,ln,pn,fn="interaction_in_progress",yn="invalid_grant",gn=483,mn=600,En=50,vn="msal.js.browser";(an=T.BrowserCacheLocation||(T.BrowserCacheLocation={})).LocalStorage="localStorage",an.SessionStorage="sessionStorage",an.MemoryStorage="memoryStorage",(cn=sn=sn||{}).GET="GET",cn.POST="POST",(dn=un=un||{}).AUTHORITY="authority",dn.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",dn.SESSION_STATE="session.state",dn.REQUEST_STATE="request.state",dn.NONCE_IDTOKEN="nonce.id_token",dn.ORIGIN_URI="request.origin",dn.RENEW_STATUS="token.renew.status",dn.URL_HASH="urlHash",dn.REQUEST_PARAMS="request.params",dn.SCOPES="scopes",dn.INTERACTION_STATUS_KEY="interaction.status",(ln=hn=hn||{})[ln.acquireTokenRedirect=861]="acquireTokenRedirect",ln[ln.acquireTokenPopup=862]="acquireTokenPopup",ln[ln.ssoSilent=863]="ssoSilent",ln[ln.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",ln[ln.handleRedirectPromise=865]="handleRedirectPromise",ln[ln.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",(pn=T.InteractionType||(T.InteractionType={})).Redirect="redirect",pn.Popup="popup",pn.Silent="silent";var Tn={scopes:[S.OPENID_SCOPE,S.PROFILE_SCOPE]},Cn="jwk",In=(Sn.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},Sn);function Sn(){}var wn=(An.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,In.decimalToHex(e[0])+In.decimalToHex(e[1])+In.decimalToHex(e[2])+In.decimalToHex(e[3])+"-"+In.decimalToHex(e[4])+In.decimalToHex(e[5])+"-"+In.decimalToHex(e[6])+In.decimalToHex(e[7])+"-"+In.decimalToHex(e[8])+In.decimalToHex(e[9])+"-"+In.decimalToHex(e[10])+In.decimalToHex(e[11])+In.decimalToHex(e[12])+In.decimalToHex(e[13])+In.decimalToHex(e[14])+In.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},An.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},An);function An(e){this.cryptoObj=e}var Rn=(_n.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:(t<2048?i[a++]=192+(t>>>6):(t<65536?i[a++]=224+(t>>>12):(t<2097152?i[a++]=240+(t>>>18):(t<67108864?i[a++]=248+(t>>>24):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63)),i[a++]=128+(t>>>18&63)),i[a++]=128+(t>>>12&63)),i[a++]=128+(t>>>6&63)),i[a++]=128+(63&t));return i},_n.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},_n.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(251<r&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:247<r&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:239<r&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:223<r&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:191<r&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},_n);function _n(){}var bn=(On.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},On.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},On.prototype.encode=function(e){var t=Rn.stringToUtf8Arr(e);return this.base64EncArr(t)},On.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0==t?r:r.substring(0,r.length-t)+(1==t?"=":"==")},On.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},On);function On(){}var kn=(Nn.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Rn.utf8ArrToString(r)},Nn.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,d=0;d<n;d++)if(s=3&d,c|=this.b64ToUint6(r.charCodeAt(d))<<18-6*s,3===s||n-d==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},Nn.prototype.b64ToUint6=function(e){return 64<e&&e<91?e-65:96<e&&e<123?e-71:47<e&&e<58?e+4:43===e?62:47===e?63:0},Nn);function Nn(){}var Pn,Un={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},tokenRequestCacheError:{code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."}},Ln=(e(Mn,Pn=te),Mn.createPkceNotGeneratedError=function(e){return new Mn(Un.pkceNotGenerated.code,Un.pkceNotGenerated.desc+" Detail:"+e)},Mn.createCryptoNotAvailableError=function(e){return new Mn(Un.cryptoDoesNotExist.code,Un.cryptoDoesNotExist.desc+" Detail:"+e)},Mn.createHttpMethodNotImplementedError=function(e){return new Mn(Un.httpMethodNotImplementedError.code,Un.httpMethodNotImplementedError.desc+" Given Method: "+e)},Mn.createEmptyNavigationUriError=function(){return new Mn(Un.emptyNavigateUriError.code,Un.emptyNavigateUriError.desc)},Mn.createEmptyHashError=function(e){return new Mn(Un.hashEmptyError.code,Un.hashEmptyError.desc+" Given Url: "+e)},Mn.createInteractionInProgressError=function(){return new Mn(Un.interactionInProgress.code,Un.interactionInProgress.desc)},Mn.createPopupWindowError=function(e){var t=Un.popUpWindowError.desc;return t=Be.isEmpty(e)?t:t+" Details: "+e,new Mn(Un.popUpWindowError.code,t)},Mn.createEmptyWindowCreatedError=function(){return new Mn(Un.emptyWindowError.code,Un.emptyWindowError.desc)},Mn.createUserCancelledError=function(){return new Mn(Un.userCancelledError.code,Un.userCancelledError.desc)},Mn.createMonitorPopupTimeoutError=function(){return new Mn(Un.monitorPopupTimeoutError.code,Un.monitorPopupTimeoutError.desc)},Mn.createMonitorIframeTimeoutError=function(){return new Mn(Un.monitorIframeTimeoutError.code,Un.monitorIframeTimeoutError.desc)},Mn.createRedirectInIframeError=function(e){return new Mn(Un.redirectInIframeError.code,Un.redirectInIframeError.desc+" (window.parent !== window) => "+e)},Mn.createBlockReloadInHiddenIframeError=function(){return new Mn(Un.blockTokenRequestsInHiddenIframeError.code,Un.blockTokenRequestsInHiddenIframeError.desc)},Mn.createIframeClosedPrematurelyError=function(){return new Mn(Un.iframeClosedPrematurelyError.code,Un.iframeClosedPrematurelyError.desc)},Mn.createSilentSSOInsufficientInfoError=function(){return new Mn(Un.silentSSOInsufficientInfoError.code,Un.silentSSOInsufficientInfoError.desc)},Mn.createSilentPromptValueError=function(e){return new Mn(Un.silentPromptValueError.code,Un.silentPromptValueError.desc+" Given value: "+e)},Mn.createTokenRequestCacheError=function(e){return new Mn(Un.tokenRequestCacheError.code,Un.tokenRequestCacheError.desc+" Error Detail: "+e)},Mn.createInvalidCacheTypeError=function(){return new Mn(Un.invalidCacheType.code,""+Un.invalidCacheType.desc)},Mn.createNonBrowserEnvironmentError=function(){return new Mn(Un.notInBrowserEnvironment.code,Un.notInBrowserEnvironment.desc)},Mn);function Mn(e,t){var r=Pn.call(this,e,t)||this;return Object.setPrototypeOf(r,Mn.prototype),r.name="BrowserAuthError",r}var qn=(Dn.prototype.generateCodes=function(){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return r=e.sent(),[2,{verifier:t,challenge:r}]}})})},Dn.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw Ln.createPkceNotGeneratedError(e)}},Dn.prototype.generateCodeChallengeFromVerifier=function(n){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(n)];case 1:return t=e.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=e.sent(),Ln.createPkceNotGeneratedError(r);case 3:return[2]}})})},Dn);function Dn(e){this.base64Encode=new bn,this.cryptoObj=e}var Hn="SHA-256",Kn=new Uint8Array([1,0,1]),xn=(Fn.prototype.sha256Digest=function(r){return y(this,void 0,void 0,function(){var t;return g(this,function(e){return t=Rn.stringToUtf8Arr(r),[2,this.hasIECrypto()?this.getMSCryptoDigest(Hn,t):this.getSubtleCryptoDigest(Hn,t)]})})},Fn.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw Ln.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},Fn.prototype.generateKeyPair=function(t,r){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(t,r):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,t,r)]})})},Fn.prototype.exportJwk=function(t){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,this.hasIECrypto()?this.msCryptoExportJwk(t):window.crypto.subtle.exportKey(Cn,t)]})})},Fn.prototype.importJwk=function(n,o,i){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){return t=Fn.getJwkString(n),r=Rn.stringToArrayBuffer(t),[2,this.hasIECrypto()?this.msCryptoImportKey(r,o,i):window.crypto.subtle.importKey(Cn,n,this._keygenAlgorithmOptions,o,i)]})})},Fn.prototype.sign=function(t,r){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,this.hasIECrypto()?this.msCryptoSign(t,r):window.crypto.subtle.sign(this._keygenAlgorithmOptions,t,r)]})})},Fn.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},Fn.prototype.hasIECrypto=function(){return"msCrypto"in window},Fn.prototype.hasBrowserCrypto=function(){return"crypto"in window},Fn.prototype.getSubtleCryptoDigest=function(t,r){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,window.crypto.subtle.digest(t,r)]})})},Fn.prototype.getMSCryptoDigest=function(n,o){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.digest(n,o.buffer);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},Fn.prototype.msCryptoGenerateKey=function(o,i){return y(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.generateKey(n._keygenAlgorithmOptions,o,i);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},Fn.prototype.msCryptoExportJwk=function(t){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,new Promise(function(n,o){var e=window.msCrypto.subtle.exportKey(Cn,t);e.addEventListener("complete",function(e){var t=e.target.result,r=Rn.utf8ArrToString(new Uint8Array(t)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{n(JSON.parse(r))}catch(e){o(e)}}),e.addEventListener("error",function(e){o(e)})})]})})},Fn.prototype.msCryptoImportKey=function(o,i,a){return y(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.importKey(Cn,o,n._keygenAlgorithmOptions,i,a);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},Fn.prototype.msCryptoSign=function(o,i){return y(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.sign(n._keygenAlgorithmOptions,o,i);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},Fn.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},Fn);function Fn(){if(!this.hasCryptoAPI())throw Ln.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Hn,modulusLength:2048,publicExponent:Kn}}var Gn=(Bn.prototype.open=function(){return y(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.indexedDB.open(n.dbName,n.version);e.addEventListener("upgradeneeded",function(e){e.target.result.createObjectStore(n.tableName)}),e.addEventListener("success",function(e){n.db=e.target.result,n.dbOpen=!0,t()}),e.addEventListener("error",function(e){return r(e)})})]})})},Bn.prototype.get=function(o){return y(this,void 0,void 0,function(){var n=this;return g(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:e.sent(),e.label=2;case 2:return[2,new Promise(function(t,r){var e=n.db.transaction([n.tableName],"readonly").objectStore(n.tableName).get(o);e.addEventListener("success",function(e){return t(e.target.result)}),e.addEventListener("error",function(e){return r(e)})})]}})})},Bn.prototype.put=function(o,i){return y(this,void 0,void 0,function(){var n=this;return g(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:e.sent(),e.label=2;case 2:return[2,new Promise(function(t,r){var e=n.db.transaction([n.tableName],"readwrite").objectStore(n.tableName).put(i,o);e.addEventListener("success",function(e){return t(e.target.result)}),e.addEventListener("error",function(e){return r(e)})})]}})})},Bn);function Bn(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}var jn=(Yn.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},Yn.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},Yn.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},Yn.prototype.generatePkceCodes=function(){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},Yn.prototype.getPublicKeyThumbprint=function(u,d){return y(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c;return g(this,function(e){switch(e.label){case 0:return[4,this.browserCrypto.generateKeyPair(Yn.EXTRACTABLE,Yn.POP_KEY_USAGES)];case 1:return t=e.sent(),[4,this.browserCrypto.exportJwk(t.publicKey)];case 2:return r=e.sent(),n={e:r.e,kty:r.kty,n:r.n},o=xn.getJwkString(n),[4,this.browserCrypto.sha256Digest(o)];case 3:return i=e.sent(),a=this.b64Encode.urlEncodeArr(new Uint8Array(i)),[4,this.browserCrypto.exportJwk(t.privateKey)];case 4:return s=e.sent(),[4,this.browserCrypto.importJwk(s,!1,["sign"])];case 5:return c=e.sent(),this.cache.put(a,{privateKey:c,publicKey:t.publicKey,requestMethod:u,requestUri:d}),[2,a]}})})},Yn.prototype.signJwt=function(h,l){return y(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c,u,d;return g(this,function(e){switch(e.label){case 0:return[4,this.cache.get(l)];case 1:return t=e.sent(),[4,this.browserCrypto.exportJwk(t.publicKey)];case 2:return r=e.sent(),n=xn.getJwkString(r),o={alg:r.alg,type:Cn},i=this.b64Encode.urlEncode(JSON.stringify(o)),h.cnf={jwk:JSON.parse(n)},a=this.b64Encode.urlEncode(JSON.stringify(h)),s=i+"."+a,c=Rn.stringToArrayBuffer(s),[4,this.browserCrypto.sign(t.privateKey,c)];case 3:return u=e.sent(),d=this.b64Encode.urlEncodeArr(new Uint8Array(u)),[2,s+"."+d]}})})},Yn.POP_KEY_USAGES=["sign","verify"],Yn.EXTRACTABLE=!0,Yn.DB_VERSION=1,Yn.TABLE_NAME=(Yn.DB_NAME="msal.db")+".keys",Yn);function Yn(){this.browserCrypto=new xn,this.b64Encode=new bn,this.b64Decode=new kn,this.guidGenerator=new wn(this.browserCrypto),this.pkceGenerator=new qn(this.browserCrypto),this.cache=new Gn(Yn.DB_NAME,Yn.TABLE_NAME,Yn.DB_VERSION)}var zn,Wn={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider."},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."}},Jn=(e(Qn,zn=te),Qn.createRedirectUriEmptyError=function(){return new Qn(Wn.redirectUriNotSet.code,Wn.redirectUriNotSet.desc)},Qn.createPostLogoutRedirectUriEmptyError=function(){return new Qn(Wn.postLogoutUriNotSet.code,Wn.postLogoutUriNotSet.desc)},Qn.createStorageNotSupportedError=function(e){return new Qn(Wn.storageNotSupportedError.code,Wn.storageNotSupportedError.desc+" Given Location: "+e)},Qn.createInvalidCallbackObjectError=function(e){return new Qn(Wn.invalidCallbackObject.code,Wn.invalidCallbackObject.desc+" Given value for callback function: "+e)},Qn.createRedirectCallbacksNotSetError=function(){return new Qn(Wn.noRedirectCallbacksSet.code,Wn.noRedirectCallbacksSet.desc)},Qn.createStubPcaInstanceCalledError=function(){return new Qn(Wn.stubPcaInstanceCalled.code,Wn.stubPcaInstanceCalled.desc)},Qn.createInMemoryRedirectUnavailableError=function(){return new Qn(Wn.inMemRedirectUnavailable.code,Wn.inMemRedirectUnavailable.desc)},Qn);function Qn(e,t){var r=zn.call(this,e,t)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,Qn.prototype),r}var Vn=(Object.defineProperty(Xn.prototype,"windowStorage",{get:function(){return this._windowStorage||(this._windowStorage=window[this.cacheLocation]),this._windowStorage},enumerable:!0,configurable:!0}),Xn.prototype.validateWindowStorage=function(e){if(e!==T.BrowserCacheLocation.LocalStorage&&e!==T.BrowserCacheLocation.SessionStorage)throw Jn.createStorageNotSupportedError(e);if(!window[e])throw Jn.createStorageNotSupportedError(e)},Xn.prototype.getItem=function(e){return this.windowStorage.getItem(e)},Xn.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},Xn.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},Xn.prototype.getKeys=function(){return Object.keys(this.windowStorage)},Xn.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},Xn);function Xn(e){this.validateWindowStorage(e),this.cacheLocation=e}var Zn=($n.prototype.getItem=function(e){return this.cache.get(e)||null},$n.prototype.setItem=function(e,t){this.cache.set(e,t)},$n.prototype.removeItem=function(e){this.cache.delete(e)},$n.prototype.getKeys=function(){var r=[];return this.cache.forEach(function(e,t){r.push(t)}),r},$n.prototype.containsKey=function(e){return this.cache.has(e)},$n);function $n(){this.cache=new Map}var eo=(to.extractBrowserRequestState=function(e,t){if(Be.isEmpty(t))return null;try{return wr.parseRequestState(e,t).libraryState.meta}catch(e){throw xe.createInvalidStateError(t,e)}},to.parseServerResponseFromHash=function(e){if(!e)return{};var t=new It(e);return It.getDeserializedHash(t.getHash())},to);function to(){}var ro,no=(e(oo,ro=Lt),oo.prototype.setupBrowserStorage=function(e){switch(e){case T.BrowserCacheLocation.LocalStorage:case T.BrowserCacheLocation.SessionStorage:try{return new Vn(e)}catch(e){return this.logger.verbose(e),this.cacheConfig.cacheLocation=T.BrowserCacheLocation.MemoryStorage,new Zn}case T.BrowserCacheLocation.MemoryStorage:default:return new Zn}},oo.prototype.migrateCacheEntries=function(){var r=this,e=S.CACHE_PREFIX+"."+h.ID_TOKEN,t=S.CACHE_PREFIX+"."+h.CLIENT_INFO,n=S.CACHE_PREFIX+"."+h.ERROR,o=S.CACHE_PREFIX+"."+h.ERROR_DESC,i=[this.browserStorage.getItem(e),this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[h.ID_TOKEN,h.CLIENT_INFO,h.ERROR,h.ERROR_DESC].forEach(function(e,t){return r.migrateCacheEntry(e,i[t])})},oo.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},oo.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},oo.prototype.getItem=function(e){return this.browserStorage.getItem(e)},oo.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},oo.prototype.getAccount=function(e){var t=this.getItem(e);if(Be.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=Lt.toObject(new kt,r);return kt.isAccountEntity(n)?n:null},oo.prototype.setAccount=function(e){var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},oo.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(Be.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=Lt.toObject(new cr,r);return cr.isIdTokenEntity(n)?n:null},oo.prototype.setIdTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},oo.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(Be.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=Lt.toObject(new hr,r);return hr.isAccessTokenEntity(n)?n:null},oo.prototype.setAccessTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},oo.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(Be.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=Lt.toObject(new fr,r);return fr.isRefreshTokenEntity(n)?n:null},oo.prototype.setRefreshTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},oo.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(Be.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=Lt.toObject(new br,r);return br.isAppMetadataEntity(e,n)?n:null},oo.prototype.setAppMetadata=function(e){var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},oo.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(Be.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=Lt.toObject(new $r,r);return $r.isServerTelemetryEntity(e,n)?n:null},oo.prototype.setServerTelemetry=function(e,t){this.setItem(e,JSON.stringify(t))},oo.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(Be.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=Lt.toObject(new tn,r);return tn.isThrottlingEntity(e,n)?n:null},oo.prototype.setThrottlingCache=function(e,t){this.setItem(e,JSON.stringify(t))},oo.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return n}var o=this.getItem(r);return Be.isEmpty(o)?null:o},oo.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(n,t)},oo.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},oo.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)},oo.prototype.getKeys=function(){return this.browserStorage.getKeys()},oo.prototype.clear=function(){var t=this;this.removeAllAccounts(),this.removeAppMetadata(),this.browserStorage.getKeys().forEach(function(e){!t.browserStorage.containsKey(e)||-1===e.indexOf(S.CACHE_PREFIX)&&-1===e.indexOf(t.clientId)||t.removeItem(e)})},oo.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},oo.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},oo.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},oo.prototype.clearMsalCookie=function(e){var t=e?this.generateNonceKey(e):this.generateStateKey(un.NONCE_IDTOKEN);this.clearItemCookie(this.generateStateKey(e)),this.clearItemCookie(t),this.clearItemCookie(this.generateCacheKey(un.ORIGIN_URI))},oo.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},oo.prototype.getCache=function(){return this.browserStorage},oo.prototype.setCache=function(){},oo.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Be.startsWith(e,S.CACHE_PREFIX)||Be.startsWith(e,h.ADAL_ID_TOKEN)?e:S.CACHE_PREFIX+"."+this.clientId+"."+e},oo.prototype.generateAuthorityKey=function(e){var t=wr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(un.AUTHORITY+"."+t)},oo.prototype.generateNonceKey=function(e){var t=wr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(un.NONCE_IDTOKEN+"."+t)},oo.prototype.generateStateKey=function(e){var t=wr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(un.REQUEST_STATE+"."+t)},oo.prototype.setAuthorityCache=function(e,t){var r=this.generateAuthorityKey(t);this.setItem(r,e)},oo.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},oo.prototype.updateCacheEntries=function(e,t,r){var n=this.generateStateKey(e);this.setTemporaryCache(n,e,!1);var o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1),this.setAuthorityCache(r,e)},oo.prototype.resetRequestCache=function(t){var r=this;this.getKeys().forEach(function(e){Be.isEmpty(t)||-1===e.indexOf(t)||r.removeItem(e)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(un.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(un.ORIGIN_URI)),this.removeItem(this.generateCacheKey(un.URL_HASH)),this.removeItem(this.generateCacheKey(un.INTERACTION_STATUS_KEY))},oo.prototype.cleanRequestByState=function(e){if(e){var t=this.generateStateKey(e),r=this.getItem(t);this.resetRequestCache(r||"")}},oo.prototype.cleanRequestByInteractionType=function(r){var n=this;this.getKeys().forEach(function(e){if(-1!==e.indexOf(un.REQUEST_STATE)){var t=n.browserStorage.getItem(e);eo.extractBrowserRequestState(n.cryptoImpl,t).interactionType===r&&n.resetRequestCache(t)}})},oo.prototype.cacheCodeRequest=function(e,t){var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(un.REQUEST_PARAMS,r,!0)},oo.prototype.getCachedRequest=function(e,t){try{var r=this.getTemporaryCache(un.REQUEST_PARAMS,!0),n=JSON.parse(t.base64Decode(r));if(this.removeItem(this.generateCacheKey(un.REQUEST_PARAMS)),Be.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);n.authority=i}return n}catch(e){throw Ln.createTokenRequestCacheError(e)}},oo);function oo(e,t,r,n){var o=ro.call(this,e,r)||this;return o.COOKIE_LIFE_MULTIPLIER=864e5,o.cacheConfig=t,o.logger=n,o.browserStorage=o.setupBrowserStorage(t.cacheLocation),o.migrateCacheEntries(),o}var io=(ao.prototype.sendGetRequestAsync=function(n,o){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return[4,fetch(n,{method:sn.GET,headers:this.getFetchHeaders(o)})];case 1:return t=e.sent(),r={headers:this.getHeaderDict(t.headers)},[4,t.json()];case 2:return[2,(r.body=e.sent(),r.status=t.status,r)]}})})},ao.prototype.sendPostRequestAsync=function(o,i){return y(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return t=i&&i.body||"",[4,fetch(o,{method:sn.POST,headers:this.getFetchHeaders(i),body:t})];case 1:return r=e.sent(),n={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 2:return[2,(n.body=e.sent(),n.status=r.status,n)]}})})},ao.prototype.getFetchHeaders=function(t){var r=new Headers;return t&&t.headers&&Object.keys(t.headers).forEach(function(e){r.append(e,t.headers[e])}),r},ao.prototype.getHeaderDict=function(e){var r={};return e.forEach(function(e,t){r[t]=e}),r},ao);function ao(){}var so=(co.prototype.sendGetRequestAsync=function(t,r){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,this.sendRequestAsync(t,sn.GET,r)]})})},co.prototype.sendPostRequestAsync=function(t,r){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,this.sendRequestAsync(t,sn.POST,r)]})})},co.prototype.sendRequestAsync=function(e,t,i){var a=this;return new Promise(function(r,n){var o=new XMLHttpRequest;if(o.open(t,e,!0),a.setXhrHeaders(o,i),o.onload=function(){(o.status<200||300<=o.status)&&n(o.responseText);try{var e=JSON.parse(o.responseText),t={headers:a.getHeaderDict(o),body:e,status:o.status};r(t)}catch(e){n(o.responseText)}},o.onerror=function(){n(o.status)},"POST"===t&&i.body)o.send(i.body);else{if("GET"!==t)throw Ln.createHttpMethodNotImplementedError(t);o.send()}})},co.prototype.setXhrHeaders=function(t,r){r&&r.headers&&Object.keys(r.headers).forEach(function(e){t.setRequestHeader(e,r.headers[e])})},co.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return t.forEach(function(e){var t=e.split(": "),r=t.shift(),n=t.join(": ");o[r]=n}),o},co);function co(){}var uo=(ho.navigateWindow=function(e,t,r,n){return n?window.location.replace(e):window.location.assign(e),new Promise(function(e){setTimeout(function(){r.warning("Expected to navigate away from the current page but timeout occurred."),e()},t)})},ho.clearHash=function(){"function"==typeof history.replaceState?history.replaceState(null,null,""+window.location.pathname+window.location.search):window.location.hash=""},ho.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=0<t.length?t.join("#"):""},ho.isInIframe=function(){return window.parent!==window},ho.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},ho.getHomepage=function(){var e=new It(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},ho.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new io:new so},ho.blockReloadInHiddenIframes=function(){if(It.hashContainsKnownProperties(window.location.hash)&&ho.isInIframe())throw Ln.createBlockReloadInHiddenIframeError()},ho.blockRedirectInIframe=function(e,t){var r=ho.isInIframe();if(e===T.InteractionType.Redirect&&r&&!t)throw Ln.createRedirectInIframeError(r)},ho.blockNonBrowserEnvironment=function(e){if(!e)throw Ln.createNonBrowserEnvironmentError()},ho.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return 0<t||0<r||0<n},ho);function ho(){}var lo=6e4,po=6e3,fo=3e4;var yo=(go.prototype.handleCodeResponse=function(c,u,d){return y(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return g(this,function(e){switch(e.label){case 0:if(Be.isEmpty(c))throw Ln.createEmptyHashError(c);return t=eo.parseServerResponseFromHash(c),r=this.browserStorage.generateStateKey(t.state),n=this.browserStorage.getTemporaryCache(r),o=this.authModule.handleFragmentResponse(c,n),i=this.browserStorage.generateNonceKey(n),a=this.browserStorage.getTemporaryCache(i),this.authCodeRequest.code=o.code,o.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(o.cloud_instance_host_name,u,d)]:[3,2];case 1:e.sent(),e.label=2;case 2:return o.nonce=a,o.state=n,[4,this.authModule.acquireToken(this.authCodeRequest,o)];case 3:return s=e.sent(),this.browserStorage.cleanRequestByState(t.state),[2,s]}})})},go.prototype.updateTokenEndpointAuthority=function(n,o,i){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return o.isAuthorityAlias(n)?[3,2]:(t="https://"+n+"/"+o.tenant+"/",[4,Xr.createDiscoveredInstance(t,i,o.protocolMode)]);case 1:r=e.sent(),this.authModule.updateAuthority(r),e.label=2;case 2:return[2]}})})},go);function go(e,t){this.authModule=e,this.browserStorage=t}var mo,Eo=(e(vo,mo=yo),vo.prototype.initiateAuthRequest=function(e,t,r){if(Be.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),Ln.createEmptyNavigationUriError();return r.redirectStartPage&&this.browserStorage.setTemporaryCache(un.ORIGIN_URI,r.redirectStartPage,!0),this.browserStorage.setTemporaryCache(un.INTERACTION_STATUS_KEY,fn,!0),this.browserStorage.cacheCodeRequest(t,this.browserCrypto),this.authModule.logger.infoPii("Navigate to:"+e),"function"!=typeof r.onRedirectNavigate?(this.authModule.logger.verbose("Navigating window to navigate url"),uo.navigateWindow(e,r.redirectTimeout,this.authModule.logger)):(this.authModule.logger.verbose("Invoking onRedirectNavigate callback"),!1!==r.onRedirectNavigate(e)?(this.authModule.logger.verbose("onRedirectNavigate did not return false, navigating"),uo.navigateWindow(e,r.redirectTimeout,this.authModule.logger)):(this.authModule.logger.verbose("onRedirectNavigate returned false, stopping navigation"),Promise.resolve()))},vo.prototype.handleCodeResponse=function(c,u,d,h){return y(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return g(this,function(e){switch(e.label){case 0:if(Be.isEmpty(c))throw Ln.createEmptyHashError(c);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(un.INTERACTION_STATUS_KEY)),t=eo.parseServerResponseFromHash(c),r=this.browserStorage.generateStateKey(t.state),n=this.browserStorage.getTemporaryCache(r),o=this.authModule.handleFragmentResponse(c,n),i=this.browserStorage.generateNonceKey(n),a=this.browserStorage.getTemporaryCache(i),this.authCodeRequest=this.browserStorage.getCachedRequest(n,this.browserCrypto),this.authCodeRequest.code=o.code,o.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(o.cloud_instance_host_name,u,d)]:[3,2];case 1:e.sent(),e.label=2;case 2:return o.nonce=a,o.state=n,h&&Qt.removeThrottle(this.browserStorage,h,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,o)];case 3:return s=e.sent(),this.browserStorage.cleanRequestByState(t.state),[2,s]}})})},vo);function vo(e,t,r){var n=mo.call(this,e,t)||this;return n.browserCrypto=r,n}var To,Co=(e(Io,To=yo),Io.prototype.initiateAuthRequest=function(e,t,r){if(Be.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),Ln.createEmptyNavigationUriError();return this.authCodeRequest=t,this.browserStorage.setTemporaryCache(un.INTERACTION_STATUS_KEY,fn,!0),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,r.popup)},Io.prototype.monitorPopupForHash=function(s,e){var c=this;return new Promise(function(r,n){e<lo&&c.authModule.logger.warning("system.loadFrameTimeout or system.windowHashTimeout set to lower ("+e+"ms) than the default ("+lo+"ms). This may result in timeouts.");var o=e/En,i=0,a=setInterval(function(){if(s.closed)return c.cleanPopup(),clearInterval(a),void n(Ln.createUserCancelledError());var e;try{e=s.location.href}catch(e){}if(!Be.isEmpty(e)&&"about:blank"!==e){i++;var t=s.location.hash;return It.hashContainsKnownProperties(t)?(c.cleanPopup(s),clearInterval(a),void r(t)):o<i?(c.cleanPopup(s),clearInterval(a),void n(Ln.createMonitorPopupTimeoutError())):void 0}},En)})},Io.prototype.openPopup=function(e,t){try{var r=void 0;if(t?(r=t).location.assign(e):void 0===t&&(r=Io.openSizedPopup(e)),!r)throw Ln.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(un.INTERACTION_STATUS_KEY)),Ln.createPopupWindowError(e.toString())}},Io.openSizedPopup=function(e){void 0===e&&(e="about:blank");var t=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=Math.max(0,n/2-gn/2+t),a=Math.max(0,o/2-mn/2+r);return window.open(e,S.LIBRARY_NAME,"width="+gn+", height="+mn+", top="+a+", left="+i)},Io.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(T.InteractionType.Popup),this.currentWindow.close(),delete e.returnValue},Io.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(un.INTERACTION_STATUS_KEY))},Io);function Io(e,t){var r=To.call(this,e,t)||this;return r.unloadWindow=r.unloadWindow.bind(r),r}var So,wo=(e(Ao,So=yo),Ao.prototype.initiateAuthRequest=function(r,n){return y(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:if(Be.isEmpty(r))throw this.authModule.logger.info("Navigate url is empty"),Ln.createEmptyNavigationUriError();return this.authCodeRequest=n,this.navigateFrameWait?[4,this.loadFrame(r)]:[3,2];case 1:return t=e.sent(),[3,3];case 2:t=this.loadFrameSync(r),e.label=3;case 3:return[2,t]}})})},Ao.prototype.monitorIframeForHash=function(a,e){var s=this;return new Promise(function(r,n){e<po&&s.authModule.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+e+"ms) than the default ("+po+"ms). This may result in timeouts.");var o=window.performance.now()+e,i=setInterval(function(){if(window.performance.now()>o)return s.removeHiddenIframe(a),clearInterval(i),void n(Ln.createMonitorIframeTimeoutError());var e;try{e=a.contentWindow.location.href}catch(e){}if(!Be.isEmpty(e)){var t=a.contentWindow.location.hash;return It.hashContainsKnownProperties(t)?(s.removeHiddenIframe(a),clearInterval(i),void r(t)):void 0}},En)})},Ao.prototype.loadFrame=function(n){var o=this;return new Promise(function(e,t){var r=o.createHiddenIframe();setTimeout(function(){r?(r.src=n,e(r)):t("Unable to load iframe")},o.navigateFrameWait)})},Ao.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},Ao.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},Ao.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},Ao);function Ao(e,t,r){var n=So.call(this,e,t)||this;return n.navigateFrameWait=r,n}var Ro;(Ro=T.EventType||(T.EventType={})).LOGIN_START="msal:loginStart",Ro.LOGIN_SUCCESS="msal:loginSuccess",Ro.LOGIN_FAILURE="msal:loginFailure",Ro.ACQUIRE_TOKEN_START="msal:acquireTokenStart",Ro.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",Ro.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",Ro.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",Ro.SSO_SILENT_START="msal:ssoSilentStart",Ro.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",Ro.SSO_SILENT_FAILURE="msal:ssoSilentFailure",Ro.HANDLE_REDIRECT_START="msal:handleRedirectStart",Ro.HANDLE_REDIRECT_END="msal:handleRedirectEnd",Ro.LOGOUT_START="msal:logoutStart",Ro.LOGOUT_SUCCESS="msal:logoutSuccess",Ro.LOGOUT_FAILURE="msal:logoutFailure";var _o=(bo.prototype.handleRedirectPromise=function(n){return y(this,void 0,void 0,function(){var t,r=this;return g(this,function(e){return this.emitEvent(T.EventType.HANDLE_REDIRECT_START,T.InteractionType.Redirect),t=this.getAllAccounts(),this.isBrowserEnvironment?[2,this.handleRedirectResponse(n).then(function(e){return e&&(t.length<r.getAllAccounts().length?r.emitEvent(T.EventType.LOGIN_SUCCESS,T.InteractionType.Redirect,e):r.emitEvent(T.EventType.ACQUIRE_TOKEN_SUCCESS,T.InteractionType.Redirect,e)),r.emitEvent(T.EventType.HANDLE_REDIRECT_END,T.InteractionType.Redirect),e}).catch(function(e){throw 0<t.length?r.emitEvent(T.EventType.ACQUIRE_TOKEN_FAILURE,T.InteractionType.Redirect,null,e):r.emitEvent(T.EventType.LOGIN_FAILURE,T.InteractionType.Redirect,null,e),r.emitEvent(T.EventType.HANDLE_REDIRECT_END,T.InteractionType.Redirect),e})]:[2,null]})})},bo.prototype.handleRedirectResponse=function(s){return y(this,void 0,void 0,function(){var t,r,n,o,i,a;return g(this,function(e){switch(e.label){case 0:return this.interactionInProgress()?(t=this.getRedirectResponseHash(s||window.location.hash),Be.isEmpty(t)?[2,null]:(r=this.browserStorage.getTemporaryCache(un.ORIGIN_URI,!0),n=It.removeHashFromUrl(r||""),o=It.removeHashFromUrl(window.location.href),n===o&&this.config.auth.navigateToLoginRequestUrl?[4,this.handleHash(t)]:[3,2])):(this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null]);case 1:return i=e.sent(),-1<r.indexOf("#")&&uo.replaceHash(r),[2,i];case 2:return this.config.auth.navigateToLoginRequestUrl?[3,3]:[2,this.handleHash(t)];case 3:return uo.isInIframe()?[3,7]:(this.browserStorage.setTemporaryCache(un.URL_HASH,t,!0),r&&"null"!==r?[3,5]:(a=uo.getHomepage(),this.browserStorage.setTemporaryCache(un.ORIGIN_URI,a,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,uo.navigateWindow(a,this.config.system.redirectNavigationTimeout,this.logger,!0)]));case 4:return e.sent(),[3,7];case 5:return[4,uo.navigateWindow(r,this.config.system.redirectNavigationTimeout,this.logger,!0)];case 6:e.sent(),e.label=7;case 7:return[2,null]}})})},bo.prototype.getRedirectResponseHash=function(e){var t=It.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(un.URL_HASH,!0);this.browserStorage.removeItem(this.browserStorage.generateCacheKey(un.URL_HASH));var n=t?e:r;if(n){var o=It.getDeserializedHash(n);return eo.extractBrowserRequestState(this.browserCrypto,o.state).interactionType!==T.InteractionType.Redirect?null:(uo.clearHash(),n)}return this.browserStorage.cleanRequestByInteractionType(T.InteractionType.Redirect),null},bo.prototype.handleHash=function(c){return y(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return g(this,function(e){switch(e.label){case 0:t=this.browserStorage.getTemporaryCache(un.REQUEST_PARAMS,!0),r=JSON.parse(this.browserCrypto.base64Decode(t)),n=this.initializeServerTelemetryManager(hn.handleRedirectPromise,r.correlationId),o=eo.parseServerResponseFromHash(c),e.label=1;case 1:return e.trys.push([1,4,,5]),i=this.browserStorage.getCachedAuthority(o.state),[4,this.createAuthCodeClient(n,i)];case 2:return a=e.sent(),[4,new Eo(a,this.browserStorage,this.browserCrypto).handleCodeResponse(c,a.authority,this.networkClient,this.config.auth.clientId)];case 3:return[2,e.sent()];case 4:throw s=e.sent(),n.cacheFailedRequest(s),this.browserStorage.cleanRequestByInteractionType(T.InteractionType.Redirect),s;case 5:return[2]}})})},bo.prototype.acquireTokenRedirect=function(d){return y(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c,u;return g(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(T.InteractionType.Redirect),(t=0<this.getAllAccounts().length)?this.emitEvent(T.EventType.ACQUIRE_TOKEN_START,T.InteractionType.Redirect,d):this.emitEvent(T.EventType.LOGIN_START,T.InteractionType.Redirect,d),r=this.preflightInteractiveRequest(d,T.InteractionType.Redirect),n=this.initializeServerTelemetryManager(hn.acquireTokenRedirect,r.correlationId),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return o=e.sent(),[4,this.createAuthCodeClient(n,r.authority)];case 3:return i=e.sent(),a=new Eo(i,this.browserStorage,this.browserCrypto),[4,i.getAuthCodeUrl(r)];case 4:return s=e.sent(),c=d&&d.redirectStartPage||window.location.href,[2,a.initiateAuthRequest(s,o,{redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:d.onRedirectNavigate})];case 5:throw u=e.sent(),t?this.emitEvent(T.EventType.ACQUIRE_TOKEN_FAILURE,T.InteractionType.Redirect,null,u):this.emitEvent(T.EventType.LOGIN_FAILURE,T.InteractionType.Redirect,null,u),n.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(r.state),u;case 6:return[2]}})})},bo.prototype.acquireTokenPopup=function(e){try{this.preflightBrowserEnvironmentCheck(T.InteractionType.Popup)}catch(e){return Promise.reject(e)}if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(e);var t=Co.openSizedPopup();return this.acquireTokenPopupAsync(e,t)},bo.prototype.acquireTokenPopupAsync=function(p,f){return y(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c,u,d,h,l;return g(this,function(e){switch(e.label){case 0:0<(t=this.getAllAccounts()).length?this.emitEvent(T.EventType.ACQUIRE_TOKEN_START,T.InteractionType.Popup,p):this.emitEvent(T.EventType.LOGIN_START,T.InteractionType.Popup,p),r=this.preflightInteractiveRequest(p,T.InteractionType.Popup),n=this.initializeServerTelemetryManager(hn.acquireTokenPopup,r.correlationId),e.label=1;case 1:return e.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return o=e.sent(),[4,this.createAuthCodeClient(n,r.authority)];case 3:return[4,(i=e.sent()).getAuthCodeUrl(r)];case 4:return a=e.sent(),s=new Co(i,this.browserStorage),c={popup:f},u=s.initiateAuthRequest(a,o,c),[4,s.monitorPopupForHash(u,this.config.system.windowHashTimeout)];case 5:return d=e.sent(),Qt.removeThrottle(this.browserStorage,this.config.auth.clientId,o.authority,o.scopes),[4,s.handleCodeResponse(d,i.authority,this.networkClient)];case 6:return h=e.sent(),t.length<this.getAllAccounts().length?this.emitEvent(T.EventType.LOGIN_SUCCESS,T.InteractionType.Popup,h):this.emitEvent(T.EventType.ACQUIRE_TOKEN_SUCCESS,T.InteractionType.Popup,h),[2,h];case 7:throw l=e.sent(),0<t.length?this.emitEvent(T.EventType.ACQUIRE_TOKEN_FAILURE,T.InteractionType.Popup,null,l):this.emitEvent(T.EventType.LOGIN_FAILURE,T.InteractionType.Popup,null,l),n.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(r.state),l;case 8:return[2]}})})},bo.prototype.ssoSilent=function(n){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(T.InteractionType.Silent),this.emitEvent(T.EventType.SSO_SILENT_START,T.InteractionType.Silent,n),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.acquireTokenByIframe(n)];case 2:return t=e.sent(),this.emitEvent(T.EventType.SSO_SILENT_SUCCESS,T.InteractionType.Silent,t),[2,t];case 3:throw r=e.sent(),this.emitEvent(T.EventType.SSO_SILENT_FAILURE,T.InteractionType.Silent,null,r),r;case 4:return[2]}})})},bo.prototype.acquireTokenByIframe=function(s){return y(this,void 0,void 0,function(){var t,r,n,o,i,a;return g(this,function(e){switch(e.label){case 0:if(Be.isEmpty(s.loginHint)&&Be.isEmpty(s.sid)&&(!s.account||Be.isEmpty(s.account.username)))throw Ln.createSilentSSOInsufficientInfoError();if(s.prompt&&s.prompt!==R.NONE)throw Ln.createSilentPromptValueError(s.prompt);t=this.initializeAuthorizationRequest(d(d({},s),{prompt:R.NONE}),T.InteractionType.Silent),r=this.initializeServerTelemetryManager(hn.ssoSilent,t.correlationId),e.label=1;case 1:return e.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=e.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return[4,(o=e.sent()).getAuthCodeUrl(t)];case 4:return i=e.sent(),[4,this.silentTokenHelper(i,n,o)];case 5:return[2,e.sent()];case 6:throw a=e.sent(),r.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(t.state),a;case 7:return[2]}})})},bo.prototype.acquireTokenByRefreshToken=function(s){return y(this,void 0,void 0,function(){var t,r,n,o,i,a;return g(this,function(e){switch(e.label){case 0:this.emitEvent(T.EventType.ACQUIRE_TOKEN_NETWORK_START,T.InteractionType.Silent,s),uo.blockReloadInHiddenIframes(),t=d(d({},s),this.initializeBaseRequest(s)),r=this.initializeServerTelemetryManager(hn.acquireTokenSilent_silentFlow,t.correlationId),e.label=1;case 1:return e.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(r,t.authority)];case 2:return[4,e.sent().acquireTokenByRefreshToken(t)];case 3:return[2,e.sent()];case 4:return n=e.sent(),r.cacheFailedRequest(n),o=n instanceof Wt,i=n instanceof vr,a=n.errorCode===yn,o&&a&&!i?[4,this.acquireTokenByIframe(s)]:[3,6];case 5:return[2,e.sent()];case 6:throw n;case 7:return[2]}})})},bo.prototype.silentTokenHelper=function(o,i,a){return y(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return[4,(t=new wo(a,this.browserStorage,this.config.system.navigateFrameWait)).initiateAuthRequest(o,i)];case 1:return r=e.sent(),[4,t.monitorIframeForHash(r,this.config.system.iframeHashTimeout)];case 2:return n=e.sent(),[2,t.handleCodeResponse(n,a.authority,this.networkClient)]}})})},bo.prototype.logout=function(i){return y(this,void 0,void 0,function(){var t,r,n,o;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.preflightBrowserEnvironmentCheck(T.InteractionType.Redirect),this.emitEvent(T.EventType.LOGOUT_START,T.InteractionType.Redirect,i),t=this.initializeLogoutRequest(i),[4,this.createAuthCodeClient(null,i&&i.authority)];case 1:return r=e.sent(),n=r.getLogoutUri(t),this.emitEvent(T.EventType.LOGOUT_SUCCESS,T.InteractionType.Redirect,t),i&&"function"==typeof i.onRedirectNavigate?!1!==i.onRedirectNavigate(n)?(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[2,uo.navigateWindow(n,this.config.system.redirectNavigationTimeout,this.logger)]):(this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),[3,3]):[2,uo.navigateWindow(n,this.config.system.redirectNavigationTimeout,this.logger)];case 2:throw o=e.sent(),this.emitEvent(T.EventType.LOGOUT_FAILURE,T.InteractionType.Redirect,null,o),o;case 3:return[2]}})})},bo.prototype.getAllAccounts=function(){return this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},bo.prototype.getAccountByUsername=function(t){var e=this.getAllAccounts();return!Be.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.username.toLowerCase()===t.toLowerCase()})[0]||null},bo.prototype.getAccountByHomeId=function(t){var e=this.getAllAccounts();return!Be.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.homeAccountId===t})[0]||null},bo.prototype.getAccountByLocalId=function(t){var e=this.getAllAccounts();return!Be.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.localAccountId===t})[0]||null},bo.prototype.getRedirectUri=function(e){var t=e||this.config.auth.redirectUri||uo.getCurrentUri();return It.getAbsoluteUrl(t,uo.getCurrentUri())},bo.prototype.getPostLogoutRedirectUri=function(e){var t=e||this.config.auth.postLogoutRedirectUri||uo.getCurrentUri();return It.getAbsoluteUrl(t,uo.getCurrentUri())},bo.prototype.getDiscoveredDefaultAuthority=function(){return y(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return this.defaultAuthority?[3,2]:(t=this,[4,Xr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.config.auth.protocolMode)]);case 1:t.defaultAuthority=e.sent(),e.label=2;case 2:return[2,this.defaultAuthority]}})})},bo.prototype.interactionInProgress=function(){return this.browserStorage.getTemporaryCache(un.INTERACTION_STATUS_KEY,!0)===fn},bo.prototype.createAuthCodeClient=function(r,n){return y(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new Mr(t)]}})})},bo.prototype.createSilentFlowClient=function(r,n){return y(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new Wr(t)]}})})},bo.prototype.createRefreshTokenClient=function(r,n){return y(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new xr(t)]}})})},bo.prototype.getClientConfiguration=function(n,o){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return Be.isEmpty(o)||o===this.config.auth.authority?[3,2]:[4,Xr.createDiscoveredInstance(o,this.config.system.networkClient,this.config.auth.protocolMode)];case 1:return r=e.sent(),[3,4];case 2:return[4,this.getDiscoveredDefaultAuthority()];case 3:r=e.sent(),e.label=4;case 4:return t=r,[2,{authOptions:{clientId:this.config.auth.clientId,authority:t,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,clientCapabilities:this.config.auth.clientCapabilities,protocolMode:this.config.auth.protocolMode},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:vn,version:"2.8.0",cpu:"",os:""}}]}})})},bo.prototype.preflightInteractiveRequest=function(e,t){if(uo.blockReloadInHiddenIframes(),this.interactionInProgress())throw Ln.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},bo.prototype.preflightBrowserEnvironmentCheck=function(e){if(uo.blockNonBrowserEnvironment(this.isBrowserEnvironment),uo.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),uo.blockReloadInHiddenIframes(),e===T.InteractionType.Redirect&&this.config.cache.cacheLocation===T.BrowserCacheLocation.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Jn.createInMemoryRedirectUnavailableError()},bo.prototype.initializeBaseRequest=function(e){var t=e.authority;Be.isEmpty(t)&&(t=this.config.auth.authority);var r=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}(e&&e.scopes||[]),n=e&&e.correlationId||this.browserCrypto.createNewGuid();return d(d({},e),{correlationId:n,authority:t,scopes:r})},bo.prototype.initializeServerTelemetryManager=function(e,t,r){var n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1};return new nn(n,this.browserStorage)},bo.prototype.initializeAuthorizationRequest=function(e,t){var r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=wr.setRequestState(this.browserCrypto,e&&e.state||"",n),i=e.nonce;Be.isEmpty(i)&&(i=this.browserCrypto.createNewGuid());var a=e.authenticationScheme||T.AuthenticationScheme.BEARER,s=d(d({},this.initializeBaseRequest(e)),{redirectUri:r,state:o,nonce:i,responseMode:_.FRAGMENT,authenticationScheme:a});if(Be.isEmpty(s.loginHint)){var c=this.browserStorage.getTemporaryCache(h.ADAL_ID_TOKEN);if(!Be.isEmpty(c)){var u=new Pt(c,this.browserCrypto);this.browserStorage.removeItem(h.ADAL_ID_TOKEN),u.claims&&u.claims.upn&&(s.loginHint=u.claims.upn)}}return this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority),s},bo.prototype.initializeAuthorizationCodeRequest=function(n){return y(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=e.sent(),r=d(d({},n),{redirectUri:n.redirectUri,code:"",codeVerifier:t.verifier}),n.codeChallenge=t.challenge,n.codeChallengeMethod=S.S256_CODE_CHALLENGE_METHOD,[2,r]}})})},bo.prototype.initializeLogoutRequest=function(e){var t=d({correlationId:this.browserCrypto.createNewGuid()},e);return t.postLogoutRedirectUri=this.getPostLogoutRedirectUri(e?e.postLogoutRedirectUri:""),t},bo.prototype.emitEvent=function(r,e,t,n){var o=this;if(this.isBrowserEnvironment){var i={eventType:r,interactionType:e||null,payload:t||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+r),this.eventCallbacks.forEach(function(e,t){o.logger.verbose("Emitting event to callback "+t+": "+r),e.apply(null,[i])})}},bo.prototype.addEventCallback=function(e){if(this.isBrowserEnvironment){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},bo.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},bo.prototype.getLogger=function(){return this.logger},bo.prototype.setLogger=function(e){this.logger=e},bo);function bo(e){this.isBrowserEnvironment="undefined"!=typeof window,this.isBrowserEnvironment&&(this.config=function(e){var t=e.auth,r=e.cache,n=e.system,o={clientId:"",authority:""+S.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:T.ProtocolMode.AAD},i={cacheLocation:T.BrowserCacheLocation.SessionStorage,storeAuthStateInCookie:!1},a={loggerCallback:function(){},logLevel:T.LogLevel.Info,piiLoggingEnabled:!1},s=d(d({},Kt),{loggerOptions:a,networkClient:uo.getBrowserNetworkClient(),loadFrameTimeout:0,windowHashTimeout:n&&n.loadFrameTimeout||lo,iframeHashTimeout:n&&n.loadFrameTimeout||po,navigateFrameWait:uo.detectIEOrEdge()?500:0,redirectNavigationTimeout:fo,asyncPopups:!1,allowRedirectInIframe:!1});return{auth:d(d({},o),t),cache:d(d({},i),r),system:d(d({},s),n)}}(e),this.browserCrypto=new jn,this.networkClient=this.config.system.networkClient,this.logger=new Ye(this.config.system.loggerOptions,"@azure/msal-browser","2.8.0"),this.browserStorage=new no(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger),this.eventCallbacks=new Map,At.setTrustedAuthoritiesFromConfig(this.config.auth.knownAuthorities,this.config.auth.cloudDiscoveryMetadata),this.defaultAuthority=null)}var Oo,ko=(e(No,Oo=_o),No.prototype.loginRedirect=function(t){return y(this,void 0,void 0,function(){return g(this,function(e){return[2,this.acquireTokenRedirect(t||Tn)]})})},No.prototype.loginPopup=function(e){return this.acquireTokenPopup(e||Tn)},No.prototype.acquireTokenSilent=function(a){return y(this,void 0,void 0,function(){var t,r,n,o,i;return g(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(T.InteractionType.Silent),t=d(d(d({},a),this.initializeBaseRequest(a)),{forceRefresh:a.forceRefresh||!1}),this.emitEvent(T.EventType.ACQUIRE_TOKEN_START,T.InteractionType.Silent,a),e.label=1;case 1:return e.trys.push([1,4,,9]),r=this.initializeServerTelemetryManager(hn.acquireTokenSilent_silentFlow,t.correlationId),[4,this.createSilentFlowClient(r,t.authority)];case 2:return[4,e.sent().acquireCachedToken(t)];case 3:return n=e.sent(),this.emitEvent(T.EventType.ACQUIRE_TOKEN_SUCCESS,T.InteractionType.Silent,n),[2,n];case 4:e.sent(),e.label=5;case 5:return e.trys.push([5,7,,8]),[4,this.acquireTokenByRefreshToken(t)];case 6:return o=e.sent(),this.emitEvent(T.EventType.ACQUIRE_TOKEN_SUCCESS,T.InteractionType.Silent,o),[2,o];case 7:throw i=e.sent(),this.emitEvent(T.EventType.ACQUIRE_TOKEN_FAILURE,T.InteractionType.Silent,null,i),i;case 8:return[3,9];case 9:return[2]}})})},No);function No(e){return Oo.call(this,e)||this}var Po={acquireTokenPopup:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},acquireTokenRedirect:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},acquireTokenSilent:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},loginPopup:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},loginRedirect:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},logout:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},ssoSilent:function(){return Promise.reject(Jn.createStubPcaInstanceCalledError)},addEventCallback:function(){return null},removeEventCallback:function(){},getLogger:function(){throw Jn.createStubPcaInstanceCalledError()},setLogger:function(){}};T.AuthError=te,T.AuthErrorMessage=ee,T.BrowserAuthError=Ln,T.BrowserAuthErrorMessage=Un,T.BrowserConfigurationAuthError=Jn,T.BrowserConfigurationAuthErrorMessage=Wn,T.BrowserUtils=uo,T.InteractionRequiredAuthError=vr,T.Logger=Ye,T.PublicClientApplication=ko,T.StringUtils=Be,T.UrlString=It,T.stubbedPublicClientApplication=Po,Object.defineProperty(T,"__esModule",{value:!0})});
